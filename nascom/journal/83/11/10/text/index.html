<!doctype html>
<html lang="de">

<!-- navi-head.php / $Date: 2023-03-11 15:22:20 +0100 (Sa, 11. Mrz 2023) $ -->
<head>
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<meta charset="utf-8">

	<link rel="shortcut icon" type="image/x-icon" href="../../../../../../nascom/nascom.ico">
	<link rel="icon" type="image/png" href="../../../../../../nascom/apple-touch-icon.png" sizes="32x32">
	<link rel="icon" type="image/png" href="../../../../../../nascom/apple-touch-icon.png" sizes="96x96">
	<link rel="apple-touch-icon" sizes="180x180" href="../../../../../../nascom/apple-touch-icon.png">

	<!--bootstrap-->
	<link rel="stylesheet" href="../../../../../../cdn/bootstrap/css/bootstrap.min.css">

	<!--font awesome-->
	<link rel="stylesheet" href="../../../../../../cdn/fontawesome/css/fontawesome.min.css">
	<link rel="stylesheet" href="../../../../../../cdn/fontawesome/css/solid.min.css">

	<link rel="stylesheet" type="text/css" href="../../../../../../style.css">
<!-- /navi-head.php -->

	<!-- page.php / $Date: 2024-07-13 18:55:41 +0200 (Sa, 13. Jul 2024) $ -->

	<title>80-Bus Journal - November 1983 - Ausgabe 10/11</title>
	<!-- Sun, 15 Dec 2024 13:33:37 GMT -->
	<meta name="keywords" content="80-Bus Journal, Nascom Computer, Nascom 1, Nascom 2">
<!-- navi-body.php -->
</head>

<body>
	<nav class="navbar navbar-expand-md navbar-light bg-light style-navbar-top" id="top">
	<div class="container-fluid">
		<a class="navbar-brand" href="https://jloh.de/">
			<img src="../../../../../../favicon.ico" width="32" height="32" alt="JL" title="Homepage von Jürgen Loh">
		</a>
		<button
			class="navbar-toggler"
			type="button"
			data-bs-toggle="collapse"
			data-bs-target="#navbarSupportedContent"
			aria-controls="navbarSupportedContent"
			aria-expanded="false"
			aria-label="Toggle navigation"
		>
			<span class="navbar-toggler-icon"></span>
		</button>
		<div class="collapse navbar-collapse robots-nocontent" id="navbarSupportedContent">
			<ul class="navbar-nav md-auto">
				<li class="nav-item">
					<a class="nav-link" href="../../../../../../z80-kit/">Z80-KIT</a>
				</li>
				<li class="nav-item">
					<a class="nav-link" href="../../../../../../nascom/1/">Nascom 1</a>
				</li>
				<li class="nav-item">
					<a class="nav-link active" href="../../../../../../nascom/">Nascom Journal</a>
				</li>
				<li class="nav-item">
					<a class="nav-link" href="../../../../../../nascom/magazines/issues/">Nascom Magazines</a>
				</li>
				<li class="nav-item">
					<a class="nav-link" href="../../../../../../pico/">PICO</a>
				</li>
				<li class="nav-item">
					<a class="nav-link" href="../../../../../../cpm-plus/">CP/M</a>
				</li>
				<li class="nav-item">
					<a class="nav-link" href="../../../../../../">Tupel BBS</a>
				</li>
			</ul>
		</div>
	</div>
	</nav>

	<div class="container" style="max-width: 750px; color: #000; padding: 0 15px 0; background-color: #FFF">

<!--********************************************************************************-->

<!-- /navi-body.php / $Date: 2024-12-15 14:31:39 +0100 (So, 15. Dez 2024) $ -->
<table class="style-table-zeropadding" style="width: 100%">
	<tr>
		<td>
			<h1 class="h1Navi">80-Bus Journal</h1>
		</td>
		<td>&nbsp;&nbsp;</td>
		<td style="vertical-align:top">
			<h2 class="h2Navi"><span class="nowrap">November 1983 &middot;</span> <span class="nowrap">Ausgabe 10/11</span></h2>
		</td>
	</tr>
</table>

<div id="head"><!-- Navigation oben -->
<table class="robots-nocontent style-table-zeropadding" style="width: 100%">
	<tr>
		<td class="navi-button">
			<a style="display: block" href="../../09/text/" title="Seite zurück"><span class="mirror-horizontal fas fa-play" aria-hidden=true></span></a>
		</td>
		<td class="navi-button">
			<a style="display: block" href="../../01/text/" title="Erste Seite"><span class="mirror-horizontal fas fa-fast-forward" aria-hidden=true></span></a>
		</td>
		<td class="navi-button">
			<a style="display: block" href="../../../../83/09/01/text/" title="Heft zurück"><span class="mirror-horizontal fas fa-forward" aria-hidden=true></span></a>
		</td>
		<th class="navi-button">
			<a style="display: block" href="../../text/" title="Inhaltsverzeichnis">Seite 10 von 52</a>
		</th>
		<td class="navi-button">
			<a style="display: block" href="../../../../83/12/01/text/" title="Heft vor"><span class="fas fa-forward" aria-hidden=true></span></a>
		</td>
		<td class="navi-button">
			<a style="display: block" href="../../52/text/" title="Letzte Seite"><span class="fas fa-fast-forward" aria-hidden=true></span></a>
		</td>
		<td class="navi-button">
			<a style="display: block" href="../../11/text/" title="Seite vor"><span class="fas fa-play" aria-hidden=true></span></a>
		</td>
	</tr>
</table>
</div><!-- /Navigation oben -->

<!-- Die Seite -->
<div class="row" id="page"><div class="col-sm-12 hyphenate" style="border: 1px solid #000; padding-top: 1em; padding-bottom: 1em;">

<!-- 2(2) Spalten im Blocksatz: Start --><div class="style-multi-column-2 justify">

<p>
aber für Floppy-Neulinge etwas zu hoch sein (ich konnte die Lücken auch
nur durch einige Telefongespräche schließen). Deshalb möchte ich hier
eine detaillierte Beschreibung anhand des Programmablaufs geben, wie
ich es in der letzten Ausgabe mit den Testroutinen gemacht habe. Den
<a href="../../../09/06/text/#article1">Artikel</a>
haben allerdings einige Leser nicht aufmerksam verfolgt, sonst
hätte sich nicht das Gerücht halten können, der Controller liefe nicht
mit
<!-- External Link --><a href="https://de.wikipedia.org/wiki/CP/M" title="Externer Link" target="_blank" rel="noreferrer">CP/M</a><!-- /External Link -->,
weil auf den Speicher unterhalb 100H durch den NMI
zugegriffen würde. Deshalb nochmals: der Bereich bei 66H wird vor den
Floppy-Zugriffen gerettet und danach wieder restauriert. Im Prinzip
wird der genannte Speicherbereich nicht angegriffen.
</p>
<p>
Nun aber zur Programmbeschreibung.
</p>
<p>
Das EMDOS wird bei A100H gestartet. Nun macht es
zunächst eine Initialisierung der Controllerkarte und versetzt sich
selbst in den Warmstart-Modus, d.h. bei erneuten Starts mit EA100 wird
die Initialisierung nicht mehr durchgeführt. Beim Auftreten
irgendwelcher Fehler könnte es aber von Vorteil sein, das EMDOS erneut
kaltzustarten. Zu diesem Zweck können Sie die Speicherzelle A187H mit
B7 laden, und ein Kaltstart wird wieder möglich. Wenn wir das DOS in
Zukunft mit einem geeigneten Urlader von der Diskette
&bdquo;booten&ldquo;, wird diese Manipulation nicht mehr nötig sein.
(Mehr dazu im
<a href="../../../12/15/text/#article1">nächsten Heft</a>).
</p>
<p>
Im folgenden nochmals die möglichen EMDOS-Anweisungen mit gekürzten
Erklärungen. Ausführlichere Beschreibungen können Sie in
<a href="../../../07/41/text/#article1">Heft 7/8 Seite 41</a> nachlesen.
</p>

<h4>
EMDOS Anweisungen
</h4>
<table>
<tr><td>L</td><td>Filename</td><td colspan=2>[neue Anfangsadresse]</td></tr>
<tr><td>S</td><td>Filename</td><td>Anfang Ende [Start&nbsp;</td><td>0 nur laden</td></tr>
<tr><td colspan=3></td><td>1 laden und RET.</td></tr>
<tr><td colspan=3></td><td>2 starten</td></tr>
<tr><td colspan=3></td><td>3 Call von EMDOS]</td></tr>
<tr><td>S</td><td>Filename&nbsp;</td><td colspan=2>(abspeichern mit gleichen Param.)</td></tr>
<tr><td>B</td><td>Filename</td><td colspan=2>(abspeichern des BASIC Programms)</td></tr>
<tr><td colspan=2>D</td><td colspan=2>(Inhaltsverzeichnis)</td></tr>
<tr><td>E</td><td>Filename</td><td colspan=2>(löschen)</td></tr>
<tr><td>R</td><td>Filename</td><td colspan=2>Anfang Länge</td></tr>
<tr><td>W&nbsp;</td><td>Filename</td><td colspan=2>Anfang Länge</td></tr>
<tr><td colspan=2>M</td><td colspan=2>(<span class="uppercase">Nassys</span> oder BASIC)</td></tr>
<tr><td colspan=2>Filename</td><td colspan=2>(laden und starten)</td></tr>
</table>

<p>
Durch die Anpassung haben sich noch zusätzliche Fehlermeldungen
ergeben. Deshalb drucken wir hier nochmals den gesamten Katalog ab.
</p>

<!-- 2 Spalten im Blocksatz: Spaltenwechsel -->

<!-- nowrap Start --><div class="style-nowrap">
<h4>
Fehlermeldungen des DOS:
</h4>
<p>
Das DOS meldet die Fehler in Form einer Fehlernummer:
</p>
<p>
10&nbsp;&ndash; Keine Diskette eingelegt<br>
11&nbsp;&ndash; Disketten Lesefehler<br>
15&nbsp;&ndash; Diskette ist schreibgeschützt<br>
16&nbsp;&ndash; Disketten Schreibfehler<br>
17&nbsp;&ndash; Falsche Laufwerksnummer<br>
1F&nbsp;&ndash; Kein Laufwerk angeschlossen<br>
20&nbsp;&ndash; File nicht gefunden<br>
21&nbsp;&ndash; Diskette voll<br>
22&nbsp;&ndash; Fileende erreicht<br>
23&nbsp;&ndash; Falscher Filename<br>
40&nbsp;&ndash; Falscher Filetyp bei L (mit W abgespeichert)<br>
41&nbsp;&ndash; Falsche Anweisung<br>
42&nbsp;&ndash; Falscher Parameter bei Load<br>
43&nbsp;&ndash; Falscher Parameter bei Save<br>
44&nbsp;&ndash; Falscher Parameter bei Read/&#x200b;Write
</p>
<!-- nowrap Ende --></div>

<p>
Die folgenden Ausführungen laufen parallel zum Asseblerlisting. Ein
Vergleich dürfte Ihnen helfen, die Funktionen zu durchschauen.
</p>
<p>
EMDOS ruft
<a href="../../12/text/#article1">PHEAS</a>
(die Schreib/&#x200b;Leseroutinen) auf und enthält in A die Funktion.
</p>
<p>
00 bedeutet dabei &bdquo;Initiieren&ldquo;. Den Programmteil INIT kennen
Sie schon aus der
<a href="../../../09/11/text/#article1">letzten Ausgabe</a>.
</p>
<p>
01 sollte das Laufwerk abstellen, wird aber nicht benutzt, da unsere
Controllerkarte das hardwaremäßig selbst besorgt, wenn nicht mehr auf
die Karte zugegriffen wird.
</p>
<p>
02 selektiert das Laufwerk. Im Register C ist die Laufwerksnummer
enthalten. Nach dieser Nummer wird die entsprechende Routine
angesprungen. Hier wird der PIOA das Steuerwort übergeben (siehe
Tabelle <a href="../../../09/08/text/#article1">Journal 9/83 Seite 8</a>)
und HL auf die Tabelle des Laufwerks
gerichtet (DSB). In dieser Tabelle findet EMDOS die Anzahl der
Sektoren, die für das Betriebssystem reserviert sind (bei meinem
augenblicklichen Format 3 Spuren mit je 10 Sektoren =30), die Anzahl
der Sektoren, die auf Spur 3 für das Inhaltsverzeichnis vorgesehen sind
(hier wurden 8 Sektoren angenommen) und die Anzahl der
&bdquo;Gruppen&ldquo;. Das sind jeweils 4 Sektoren (also zusammen 1
KByte). Da wir mit unserem Format im Augenblick 92K speichern können,
entspricht das 92 Gruppen.
</p>
<p>
Entsprechend PINIT und PSEL werden durch 03 und 04 im Akku die Lese-
bzw. Schreibroutinen aufgerufen.
</p>
<p>
Die Routine TSTHOM testet, woher eine Fehlermeldung kommt, (gesetztes
Carry-Flag weist immer auf einen Fehler hin. Deshalb auch immer das
SCF/&#x200b;Set Carry Flag bei den
</p>

<!-- 2 Spalten: Ende --></div>

</div></div>
<!-- /Die Seite -->

<!-- Navigation unten -->
<table class="robots-nocontent style-table-zeropadding" style="width: 100%">
	<tr>
		<td class="navi-button">
			<a style="display: block" href="../../09/text/" title="Seite zurück"><span class="mirror-horizontal fas fa-play" aria-hidden=true></span></a>
		</td>
		<td class="navi-button">
			<a style="display: block" href="../../01/text/" title="Erste Seite"><span class="mirror-horizontal fas fa-fast-forward" aria-hidden=true></span></a>
		</td>
		<td class="navi-button">
			<a style="display: block" href="../../../../83/09/01/text/" title="Heft zurück"><span class="mirror-horizontal fas fa-forward" aria-hidden=true></span></a>
		</td>
		<th class="navi-button">
			<a style="display: block" href="../../text/" title="Inhaltsverzeichnis">Seite 10 von 52</a>
		</th>
		<td class="navi-button">
			<a style="display: block" href="../../../../83/12/01/text/" title="Heft vor"><span class="fas fa-forward" aria-hidden=true></span></a>
		</td>
		<td class="navi-button">
			<a style="display: block" href="../../52/text/" title="Letzte Seite"><span class="fas fa-fast-forward" aria-hidden=true></span></a>
		</td>
		<td class="navi-button">
			<a style="display: block" href="../../11/text/" title="Seite vor"><span class="fas fa-play" aria-hidden=true></span></a>
		</td>
	</tr>
</table>
<!-- /Navigation unten -->

<!-- navi-footer.php / $Date: 2023-03-11 15:22:20 +0100 (Sa, 11. Mrz 2023) $ -->

<!--********************************************************************************-->

	</div>

	<nav class="nav flex-column flex-md-row style-navbar-bottom robots-nocontent"> <!--nav-pills-->
		<a class="sm-fill nav-link" href="#top"><span title="Nach oben" class="fa fa-chevron-up" aria-hidden=true></span></a>
		<!--a class="sm-fill nav-link disabled">Text</a-->
		<a class="sm-fill nav-link" href="../">Grafik</a>
		<a class="sm-fill nav-link" href="../../thumb/text/">Miniatur&shy;bilder</a>
		<a class="sm-fill nav-link" href="../../../../../../nascom/journal/pdf/83-11.pdf" download>PDF</a>
		<a class="sm-fill nav-link" href="../../../../../../datenschutzerklaerung/">Datenschutzerklärung</a>
		<a class="sm-fill nav-link" href="../../../../../../impressum/">Impressum</a>
	</nav>

	<!--bootstrap-->
	<script src="../../../../../../cdn/bootstrap/js/bootstrap.bundle.min.js"></script>
</body>

<!-- /navi-footer.php -->
</html>

<!-- /page.php -->