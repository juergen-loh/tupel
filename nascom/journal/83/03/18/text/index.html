<!doctype html>
<html lang="de">

<!-- navi-head.php / $Date: 2025-01-05 17:13:18 +0100 (So, 05. Jan 2025) $ -->
<head>
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<meta charset="utf-8">

	<link rel="shortcut icon" type="image/x-icon" href="../../../../../../nascom/nascom.ico">
	<link rel="icon" type="image/png" href="../../../../../../nascom/apple-touch-icon.png" sizes="32x32">
	<link rel="icon" type="image/png" href="../../../../../../nascom/apple-touch-icon.png" sizes="96x96">
	<link rel="apple-touch-icon" sizes="180x180" href="../../../../../../nascom/apple-touch-icon.png">

	<!--bootstrap-->
	<link rel="stylesheet" href="../../../../../../cdn/bootstrap/css/bootstrap.min.css">

	<!--font awesome-->
	<link rel="stylesheet" href="../../../../../../cdn/fontawesome/css/fontawesome.min.css">
	<link rel="stylesheet" href="../../../../../../cdn/fontawesome/css/solid.min.css">

	<link rel="stylesheet" type="text/css" href="../../../../../../style.css">
	<link rel="canonical" href="https://tupel.jloh.de/nascom/journal/83/03/18/text/">
<!-- /navi-head.php -->

	<!-- page.php / $Date: 2024-07-13 18:55:41 +0200 (Sa, 13. Jul 2024) $ -->

	<title>80-Bus Journal - März 1983 - Ausgabe 3</title>
	<!-- Sun, 16 Mar 2025 14:14:42 GMT -->
	<meta name="keywords" content="80-Bus Journal, Nascom Computer, Nascom 1, Nascom 2">
<!-- navi-body.php -->
</head>

<body>
	<nav class="navbar navbar-expand-md navbar-light bg-light style-navbar-top" id="top">
	<div class="container-fluid">
		<a class="navbar-brand" href="https://jloh.de/">
			<img src="../../../../../../favicon.ico" width="32" height="32" alt="JL" title="Homepage von Jürgen Loh">
		</a>
		<button
			class="navbar-toggler"
			type="button"
			data-bs-toggle="collapse"
			data-bs-target="#navbarSupportedContent"
			aria-controls="navbarSupportedContent"
			aria-expanded="false"
			aria-label="Toggle navigation"
		>
			<span class="navbar-toggler-icon"></span>
		</button>
		<div class="collapse navbar-collapse robots-nocontent" id="navbarSupportedContent">
			<ul class="navbar-nav md-auto">
				<li class="nav-item">
					<a class="nav-link" href="../../../../../../z80-kit/">Z80-KIT</a>
				</li>
				<li class="nav-item">
					<a class="nav-link" href="../../../../../../nascom/1/">Nascom 1</a>
				</li>
				<li class="nav-item">
					<a class="nav-link active" href="../../../../../../nascom/">Nascom Journal</a>
				</li>
				<li class="nav-item">
					<a class="nav-link" href="../../../../../../nascom/magazines/issues/">Nascom Magazines</a>
				</li>
				<li class="nav-item">
					<a class="nav-link" href="../../../../../../pico/">PICO</a>
				</li>
				<li class="nav-item">
					<a class="nav-link" href="../../../../../../cpm-plus/">CP/M</a>
				</li>
				<li class="nav-item">
					<a class="nav-link" href="../../../../../../">Tupel BBS</a>
				</li>
			</ul>
		</div>
	</div>
	</nav>

	<div class="container" style="max-width: 750px; color: #000; padding: 0 15px 0; background-color: #FFF">

<!--********************************************************************************-->

<!-- /navi-body.php / $Date: 2025-03-16 15:14:42 +0100 (So, 16. Mrz 2025) $ -->
<table class="style-table-zeropadding" style="width: 100%">
	<tr>
		<td>
			<h1 class="h1Navi">80-Bus Journal</h1>
		</td>
		<td>&nbsp;&nbsp;</td>
		<td style="vertical-align:top">
			<h2 class="h2Navi"><span class="nowrap">März 1983 &middot;</span> <span class="nowrap">Ausgabe 3</span></h2>
		</td>
	</tr>
</table>

<div id="head"><!-- Navigation oben -->
<table class="robots-nocontent style-table-zeropadding" style="width: 100%">
	<tr>
		<td class="navi-button">
			<a style="display: block" href="../../17/text/" title="Seite zurück"><span class="mirror-horizontal fas fa-play" aria-hidden=true></span></a>
		</td>
		<td class="navi-button">
			<a style="display: block" href="../../01/text/" title="Erste Seite"><span class="mirror-horizontal fas fa-fast-forward" aria-hidden=true></span></a>
		</td>
		<td class="navi-button">
			<a style="display: block" href="../../../../83/02/01/text/" title="Heft zurück"><span class="mirror-horizontal fas fa-forward" aria-hidden=true></span></a>
		</td>
		<th class="navi-button">
			<a style="display: block" href="../../text/" title="Inhaltsverzeichnis">Seite 18 von 32</a>
		</th>
		<td class="navi-button">
			<a style="display: block" href="../../../../83/04/01/text/" title="Heft vor"><span class="fas fa-forward" aria-hidden=true></span></a>
		</td>
		<td class="navi-button">
			<a style="display: block" href="../../32/text/" title="Letzte Seite"><span class="fas fa-fast-forward" aria-hidden=true></span></a>
		</td>
		<td class="navi-button">
			<a style="display: block" href="../../19/text/" title="Seite vor"><span class="fas fa-play" aria-hidden=true></span></a>
		</td>
	</tr>
</table>
</div><!-- /Navigation oben -->

<!-- Die Seite -->
<div class="row" id="page"><div class="col-sm-12 hyphenate" style="border: 1px solid #000; padding-top: 1em; padding-bottom: 1em;">

<!-- 2(2) Spalten im Blocksatz: Start --><div class="style-multi-column-2 justify">

<h1 id="article1" class="uppercase">
Vectorgrafik
</h1>
<h3>
von <!-- External Link --><a href="https://michaelbach.de/" title="Externer Link" target="_blank" rel="noreferrer">Michael Bach</a><!-- /External Link -->
</h3>
<p>
Also: Beiliegendes Programm enthält nach einem kurzen (aber
eindrucksvollen)
<a href="../../../02/11/text/#article2">Demo</a>
vorne dran 3 wesentliche Unterprogramme: PLOT(X,&#x200b;Y,&#x200b;Z), LINIE(X1,&#x200b;Y1,&#x200b;Z)
und KREIS (R). Bei PLOT werden also 3 Parameter
übergeben: X-Wert in DE, Y-Wert in HL, und Z in A. Z wählt zwischen
Punkt löschen, setzen und invertieren aus. Die Koordinaten brauchten
eigentlich nicht in 16-Bit-Registem übergeben zu werden, aber so wird
das Programm unniverseller und Plotten außerhalb des
Bildschirmbereiches kann in einfacher Weise unterdrückt werden.
Zunächst werden alle Register mit PUSH auf dem Stack aufgehoben. AF
noch einmal mehr, da A noch gebraucht und in DISCOR verändert wird.
DISCOR überprüft die Koordinaten und kehrt bei Bereichsüberschreitung
mit gelöschtem setzten Carry sofort zurück, andernfalls errechnet es aus
den Koordinaten die Bildschirmadresse (in HL) und das innerhalb einer
Zeichenposition zu setzende Klötzchen als Bitmuster in B, in A wird C0H
geladen well von C0H-FFH der Zeichengenerator auf Grafik steht. In PLOT
wird dann das alte AF in DE &bdquo;gepoppt&ldquo; (in AF ginge nicht da
dann das Carry verlorenginge). Bei gelöschtem Carry wird PLOT sofort
verlassen (JR PLTRET). CP (HL) guckt nach, ob an dieser Adresse schon
Grafik ist. Wenn nicht, wird auf Grafik umgeschaltet und vorhandenes
Zeichen gelöscht. Dann gibt es 3 Möglichkeiten: Punkt löschen (dann
kann D bzw. A nicht 0 sein), Punkt setzen (A-1=0) oder invertieren. Bei
Löschen wird das Bitmuster in B bzw. A invertiert (CPL) und eine
AND-Verknüpfung mit dem Bildschirminhalt vorgenommen. Das löscht das
entsprechende Klötzchen. Bei Punkt setzen wird mit einer
ODER-Verknüpfung das Klötzchen hell und evtl. schon vorhandene
Nachbarklötzchen bleiben erhalten. Invertieren sollte damit eigentlich
auch klar sein. Zum Abschluß von PLOT werden alle beteiligten Register
wieder auf ihren Anfangszustand gebracht (in POARET).
</p>
<p>
In DISCOR werden als Test auf Bereichsüberschreitung zunächst die
höherwertigen Register von DE und HL auf 0 überprüft. Dies geschieht
nicht etwa mit LD A,H CP 0 .. LD A,D CP 0 sondern mit LD A,H OR D. Wenn
in H oder D irgendein Bit gesetzt ist, ist nach OR D die Z-Flagge
zurückgesetzt. Danach muß man halt die Register E und L noch
überprüfen. Die Y-Achse wird invertiert damit der 0-Punkt unten links
ist. Den folgenden Algorithmus zum Berechnen der Bildschirmadresse und
des Bitmuster erkläre ich nicht, ich habe ihn auch selber nicht ganz
verstanden sondern aus dem Pascal übernommen. Auf jeden Fall ist er
schneller &amp; einfacher als mein alter Algorithmus.
</p>

<!-- 2 Spalten im Blocksatz: Spaltenwechsel -->

<p>
Jetzt zu LINIE: Eigentlich braucht man zum Zeichnen einer Linie 5
Parameter: X0,Y0,&#x200b;X1,Y1,&#x200b;Z. Das ist aber unpraktisch, außerdem ist es oft
so, daß man als Anfangspunkt einer Linie den Endpunkt der
vorhergehenden Linie benutzt. Deshalb gibt es SETZXY, das den
Anfangspunkt der Linie in den RAM-Variablen X0,Y0 ablegt. LINIE kriegt
nur X1,Y1 und sorgt dafür, daß hinterher X1&ndash;)X0 und Y1&ndash;)Y0. Etwas
Kopfzerbrechen bereitete mir die Frage wo die Variablen im RAM
unterzubringen seien, da das Program auch im Eprom laufen soll. Ich
schlage dafür die Speicherstellen 0C1CH-0C1FH vor, die als 9. und 10.
Argument bei <span class="uppercase">Nassys</span> reserviert und bestimmt nie gebraucht werden. Es
ist garnicht so simpel, zwischen 2 Punkten auf dem Bildschirm eine
Linie zu zeichnen, die die beste Anpassung in der Grafikauflösung
darstellt. Ich habe eine Veröffentlichung von B. K. Horn,
&bdquo;<!-- External Link --><a href="https://people.csail.mit.edu/bkph/papers/Circle_Generators_OPT.pdf" title="Externer Link" target="_blank" rel="noreferrer">Circle Generators for Display Devices</a><!-- /External Link -->&ldquo;
Comp. Graphics &amp; Image Proc.
5,280-288 (1976) zugrunde gelegt, die ohne Multiplikation auskommt
(aber anders ist das was ich schon &rsquo;mal in Pascal beschrieben hab) der
Algorithmus ist Pascal-ähnlich sehr einfach zu formulieren:
</p>

<img class="img-fluid" src="../../Image-18-1.jpeg" alt="" width="320" height="284">

<p>
Das habe ich ziemlich &bdquo;wörtlich&ldquo; in Assembler übersetzt,
lästig ist natürlich die 16-Bit-Arithmetik (mit dem 6809 z.B. geht das
viel einfacher, mit dem 9900 auch aber das ist &rsquo;eh eine 16-Bit-CPU und
sonst recht unschön). Ein Programmiertrick, den ich noch nie irgendwo
anders gesehenhabe, spart RAM-Platz (Eprom-Version!), den man
eigentlich für die Variablen NEGX,&#x200b;A,&#x200b;B,&#x200b;X,&#x200b;Y &amp;sw. benötigte: Bei LIO
wird der Stackpointer um 6 dekrementiert und IX erhält den Wert von SP.
Dann kann man relativ zu IX (ins Positive) innerhalb dieses
</p>

<!-- 2 Spalten: Ende --></div>

</div></div>
<!-- /Die Seite -->

<!-- Navigation unten -->
<table class="robots-nocontent style-table-zeropadding" style="width: 100%">
	<tr>
		<td class="navi-button">
			<a style="display: block" href="../../17/text/" title="Seite zurück"><span class="mirror-horizontal fas fa-play" aria-hidden=true></span></a>
		</td>
		<td class="navi-button">
			<a style="display: block" href="../../01/text/" title="Erste Seite"><span class="mirror-horizontal fas fa-fast-forward" aria-hidden=true></span></a>
		</td>
		<td class="navi-button">
			<a style="display: block" href="../../../../83/02/01/text/" title="Heft zurück"><span class="mirror-horizontal fas fa-forward" aria-hidden=true></span></a>
		</td>
		<th class="navi-button">
			<a style="display: block" href="../../text/" title="Inhaltsverzeichnis">Seite 18 von 32</a>
		</th>
		<td class="navi-button">
			<a style="display: block" href="../../../../83/04/01/text/" title="Heft vor"><span class="fas fa-forward" aria-hidden=true></span></a>
		</td>
		<td class="navi-button">
			<a style="display: block" href="../../32/text/" title="Letzte Seite"><span class="fas fa-fast-forward" aria-hidden=true></span></a>
		</td>
		<td class="navi-button">
			<a style="display: block" href="../../19/text/" title="Seite vor"><span class="fas fa-play" aria-hidden=true></span></a>
		</td>
	</tr>
</table>
<!-- /Navigation unten -->

<!-- navi-footer.php / $Date: 2023-03-11 15:22:20 +0100 (Sa, 11. Mrz 2023) $ -->

<!--********************************************************************************-->

	</div>

	<nav class="nav flex-column flex-md-row style-navbar-bottom robots-nocontent"> <!--nav-pills-->
		<a class="sm-fill nav-link" href="#top"><span title="Nach oben" class="fa fa-chevron-up" aria-hidden=true></span></a>
		<!--a class="sm-fill nav-link disabled">Text</a-->
		<a class="sm-fill nav-link" href="../">Grafik</a>
		<a class="sm-fill nav-link" href="../../thumb/text/">Miniatur&shy;bilder</a>
		<a class="sm-fill nav-link" href="../../../../../../nascom/journal/pdf/83-03.pdf" download>PDF</a>
		<a class="sm-fill nav-link" href="../../../../../../datenschutzerklaerung/">Datenschutzerklärung</a>
		<a class="sm-fill nav-link" href="../../../../../../impressum/">Impressum</a>
	</nav>

	<!--bootstrap-->
	<script src="../../../../../../cdn/bootstrap/js/bootstrap.bundle.min.js"></script>
</body>

<!-- /navi-footer.php -->
</html>

<!-- /page.php -->