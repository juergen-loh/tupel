<!doctype html>
<html lang="de">

<!-- navi-head.php / $Date: 2025-01-05 17:13:18 +0100 (So, 05. Jan 2025) $ -->
<head>
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<meta charset="utf-8">

	<link rel="shortcut icon" type="image/x-icon" href="../../../../../../nascom/nascom.ico">
	<link rel="icon" type="image/png" href="../../../../../../nascom/apple-touch-icon.png" sizes="32x32">
	<link rel="icon" type="image/png" href="../../../../../../nascom/apple-touch-icon.png" sizes="96x96">
	<link rel="apple-touch-icon" sizes="180x180" href="../../../../../../nascom/apple-touch-icon.png">

	<!--bootstrap-->
	<link rel="stylesheet" href="../../../../../../cdn/bootstrap/css/bootstrap.min.css">

	<!--font awesome-->
	<link rel="stylesheet" href="../../../../../../cdn/fontawesome/css/fontawesome.min.css">
	<link rel="stylesheet" href="../../../../../../cdn/fontawesome/css/solid.min.css">

	<link rel="stylesheet" type="text/css" href="../../../../../../style.css">
	<link rel="canonical" href="https://tupel.jloh.de/nascom/journal/82/09/03/text/">
<!-- /navi-head.php -->

	<!-- page.php / $Date: 2024-07-13 18:55:41 +0200 (Sa, 13. Jul 2024) $ -->

	<title>Nascom Journal - September 1982 - Ausgabe 9</title>
	<!-- Thu, 17 Apr 2025 20:37:45 GMT -->
	<meta name="keywords" content="Nascom Journal, Nascom Computer, Nascom 1, Nascom 2">
<!-- navi-body.php -->
</head>

<body>
	<nav class="navbar navbar-expand-md navbar-light bg-light style-navbar-top" id="top">
	<div class="container-fluid">
		<a class="navbar-brand" href="https://jloh.de/">
			<img src="../../../../../../favicon.ico" width="32" height="32" alt="JL" title="Homepage von Jürgen Loh">
		</a>
		<button
			class="navbar-toggler"
			type="button"
			data-bs-toggle="collapse"
			data-bs-target="#navbarSupportedContent"
			aria-controls="navbarSupportedContent"
			aria-expanded="false"
			aria-label="Toggle navigation"
		>
			<span class="navbar-toggler-icon"></span>
		</button>
		<div class="collapse navbar-collapse robots-nocontent" id="navbarSupportedContent">
			<ul class="navbar-nav md-auto">
				<li class="nav-item">
					<a class="nav-link" href="../../../../../../z80-kit/">Z80-KIT</a>
				</li>
				<li class="nav-item">
					<a class="nav-link" href="../../../../../../nascom/1/">Nascom 1</a>
				</li>
				<li class="nav-item">
					<a class="nav-link active" href="../../../../../../nascom/">Nascom Journal</a>
				</li>
				<li class="nav-item">
					<a class="nav-link" href="../../../../../../nascom/magazines/issues/">Nascom Magazines</a>
				</li>
				<li class="nav-item">
					<a class="nav-link" href="../../../../../../pico/">PICO</a>
				</li>
				<li class="nav-item">
					<a class="nav-link" href="../../../../../../cpm-plus/">CP/M</a>
				</li>
				<li class="nav-item">
					<a class="nav-link" href="../../../../../../">Tupel BBS</a>
				</li>
			</ul>
		</div>
	</div>
	</nav>

	<div class="container" style="max-width: 750px; color: #000; padding: 0 15px 0; background-color: #FFF">

<!--********************************************************************************-->

<!-- /navi-body.php / $Date: 2025-03-22 17:02:11 +0100 (Sa, 22. Mrz 2025) $ -->
<table class="style-table-zeropadding" style="width: 100%">
	<tr>
		<td>
			<h1 class="h1Navi">Nascom Journal</h1>
		</td>
		<td>&nbsp;&nbsp;</td>
		<td style="vertical-align:top">
			<h2 class="h2Navi"><span class="nowrap">September 1982 &middot;</span> <span class="nowrap">Ausgabe 9</span></h2>
		</td>
	</tr>
</table>

<div id="head"><!-- Navigation oben -->
<table class="robots-nocontent style-table-zeropadding" style="width: 100%">
	<tr>
		<td class="navi-button">
			<a style="display: block" href="../../02/text/" title="Seite zurück"><span class="mirror-horizontal fas fa-play" aria-hidden=true></span></a>
		</td>
		<td class="navi-button">
			<a style="display: block" href="../../01/text/" title="Erste Seite"><span class="mirror-horizontal fas fa-fast-forward" aria-hidden=true></span></a>
		</td>
		<td class="navi-button">
			<a style="display: block" href="../../../../82/07/01/text/" title="Heft zurück"><span class="mirror-horizontal fas fa-forward" aria-hidden=true></span></a>
		</td>
		<th class="navi-button">
			<a style="display: block" href="../../text/" title="Inhaltsverzeichnis">Seite 3 von 28</a>
		</th>
		<td class="navi-button">
			<a style="display: block" href="../../../../82/10/01/text/" title="Heft vor"><span class="fas fa-forward" aria-hidden=true></span></a>
		</td>
		<td class="navi-button">
			<a style="display: block" href="../../28/text/" title="Letzte Seite"><span class="fas fa-fast-forward" aria-hidden=true></span></a>
		</td>
		<td class="navi-button">
			<a style="display: block" href="../../04/text/" title="Seite vor"><span class="fas fa-play" aria-hidden=true></span></a>
		</td>
	</tr>
</table>
</div><!-- /Navigation oben -->

<!-- Die Seite -->
<div class="row" id="page"><div class="col-sm-12 hyphenate" style="border: 1px solid #000; padding-top: 1em; padding-bottom: 1em;">

<!-- 2(2) Spalten im Blocksatz: Start --><div class="style-multi-column-2 justify">

<h1 id="article1">
DMA &ndash; Teil&nbsp;2
</h1>
<h3>
von Josef Zeller
</h3>
<p>
Im <a href="../../../../81/09/05/text/#article2"><span class="uppercase">Nascom</span>-Journal 9/81</a>
wurde eine Applikation mit dem
<!-- External Link --><a href="https://www.zilog.com/docs/z80/ps0179.pdf" title="Externer Link: Z80 DMA" target="_blank" rel="noreferrer">Z80-DMA</a><!-- /External Link -->-Baustein
vorgestellt. Angeregt durch Anfragen soll hier dieser Baustein etwas
näher beschrieben werden. Anhand von Programmbeispielen (bereits im
<a href="../../../07/49/text/#article1"><span class="uppercase">Nascom</span>-Journal 7/8-82</a>
abgedruckt! RED.) soll die Programmierung dieses
komplexen Bausteins erläutert werden.
</p>
<p>
Der Beitrag ist die gekürzte
Fassung eines Artikels, der in <span class="uppercase">Markt&amp;Technik</span> 16/82 erschienen ist.
</p>
<h4>
1) Z80-DMA &ndash; Funktionsbeschreibung
</h4>
<p>
Der Z80-DMA-Controller soll hier nur
soweit beschrieben werden, um einen ersten Eindruck über die
Möglichkeiten dieses intelligenten Coprozessors zu gewinnen. Für
genauere Details sei auf das Datenblatt verwiesen. Der DMA-Baustein
verfügt, um mit den anderen Komponenten im Mikrocomputersystem in
Verbindung zu treten, über eine interne Logik und Anschlüsse nach
außen, die es erlauben, die Adreß-, Daten- und Kontrolleitungen wie die
CPU zu steuern, Interrupts zur CPU zu senden und die Busverwaltung mit
der CPU und anderen DMAs zu koordinieren. Zum Transfer von Daten sind
dafür die Adreß-, Daten- und Kontrolleitungen (MREQ, IORQ, RD, WR) in
ihrer Funktion identisch den entsprechenden Anschlüssen der CPU. Auch
ist das Timing des DMA gleich dem der CPU. Die Logik der
Interruptanforderung entspricht der aller anderen
<!-- External Link --><a href="https://de.wikipedia.org/wiki/Zilog_Z80" title="Externer Link" target="_blank" rel="noreferrer">Z80</a><!-- /External Link -->-Peripheriebausteine
(<!-- External Link --><a href="https://www.zilog.com/docs/z80/ps0180.pdf" title="Externer Link: Z80 PIO" target="_blank" rel="noreferrer">PIO</a><!-- /External Link -->,
<!-- External Link --><a href="https://www.zilog.com/docs/z80/ps0181.pdf" title="Externer Link: Z80 CTC" target="_blank" rel="noreferrer">CTC</a><!-- /External Link -->,
<!-- External Link --><a href="https://datasheet.datasheetarchive.com/originals/scans/Scans-97/DSAIHSC00072076.pdf" title="Externer Link: Z80 DART" target="_blank" rel="noreferrer">DART</a><!-- /External Link -->,
<!-- External Link --><a href="https://www.zilog.com/docs/z80/ps0183.pdf" title="Externer Link: Z80 SIO" target="_blank" rel="noreferrer">SIO</a><!-- /External Link -->). Sie erlaubt damit über
IEI und IEO eine hardwaremäßige Zuweisung der Priorität einer
Interruptanforderung von einem I/O-Baustein und die Z80-spezifischen
Vektorinterrupts. Anhand von
<a href="../../../07/50/text/#article1">Programmbeispiel 3</a>
wird gezeigt, wie das
Low Byte des Interruptvektors in den DMA geladen wird und bei welchen
Ereignissen der DMA einen Interrupt auslösen kann. Der Zugriff auf den
Bus wird gesteuert durch BUSREQ, BAI, und BAO. Ueber BUSREQ (Bus
Request) teilt der DMA der CPU mit, daß er die Kontrolle über den Bus
übernehmen will. Die CPU behandelt BUSREQ-Anforderungen noch vor dem
nichtmaskierbaren Interrupt und dem normalen Interrupt. Ueber den
BUSACK-Eingang der CPU, der mit dem BAI des höchstpriorisierten DMA
verbunden ist, meldet die CPU, daß sie den Bus freigegeben hat und der
DMA den Bus übernehmen kann. Durch BAI

<!-- 2 Spalten im Blocksatz: Spaltenwechsel -->

und BAO können
Multi-DMA-Kon&shy;fi&shy;gu&shy;ra&shy;tio&shy;nen
aufgebaut werden. Dazu wird
immer BAO vom höherpriorisierten DMA mit BAI vom niederpriorisierten
DMA verbunden (Daisy-Chain-Prinzip!). Der BUSREQ-Pin der CPU überwacht
im inaktiven Zustand des DMA den Bus und stellt fest, ob ein anderer
DMA aktiv ist. Dadurch wird der Zugriff auf den Bus erst erlaubt, wenn
der andere DMA sich vom Bus zurückgezogen hat. Ein DMA mit hoher
Priorität kann den aktiven DMA mit niedriger Priorität also nicht
unterbrechen, sondern muß warten, bis dieser fertig ist. Den Pins CE
und WAIT sind je zwei verschiedene Funktionen zugewiesen. Im passiven
Zustand dient CE als Chip-Select und über INT wird das Interruptsignal
ausgegeben. Durch Programmierung kann der CE als Wait-Eingang dienen
und der INT-Pin das Puls-Signal aussenden, wenn ein Block von
programmierbarer Länge übertragen worden ist. Durch den RDY-Eingang
kann ein Peripherie-Baustein (SIO durch W/RDYA oder W/RDYB) den DMA
zum Uebertragen auffordern.
</p>
<p>
Der DMA weist 3 Funktionsarten auf, die in den Programmbeispielen auch
angewandt werden: Übertragung
(<a href="../../../07/49/text/#article1">Prg. 1</a>),
Suche
(<a href="../../../07/49/text/#article1">Prg. 2</a>)
und kombinierte Suche/&#x200b;Übertragung
(<a href="../../../07/50/text/#article1">Prg. 3</a>)
von Daten zwischen 2 Ports. Ein Port kann
ein Memorybereich oder ein I/O-Baustein sein. Die Startadressen, ab
denen die Übertragung beginnt, werden in die Port-Start-Register und
die Übertragungslänge ins Block-Lenght-Register geladen. Es sind
Blocklängen bis 64&nbsp;K-Byte adressierbar. Die Counter können von der CPU
ausgelesen werden und zeigen an, bis zu welcher Adresse und wieviel
Bytes übertragen wurden
(<a href="../../../07/52/text/#article1">Programm Global</a>).
Der DMA kann einen Port
nach einem bestimmten Byte oder einer Bitkombination absuchen. Beim
Übertragen wird ein Byte von einem Port gelesen und dann zum anderen
Port geschrieben. Beim Übertragen/&#x200b;Suchen kann so lange übertragen
werden, bis Gleichheit auftritt. Die Optionen werden hier meistens
anhand der Übertragung von Daten besprochen. Natürlich gilt das Gesagte
auch für die Datensuche.
<span style="text-decoration: line-through">lich gilt das Gesagte
auch für die Datensuche.</span>
Der Z80-DMA kann in drei Betriebsarten arbeiten. Im Byte-Mode wird pro
Busanforderung nur ein Byte übertragen. Die CPU fuhrt dann einen Befehl
aus, bevor der DMA das nächste Byte überträgt. Um im Byte-Mode zu
arbeiten, muß RDY aktiv sein. Im Burst-Mode werden Daten so lange
übertragen, wie RDY aktiv ist, auch wenn die Operation noch nicht
abgeschlossen ist. Im Continuous-Mode ist der DMA so lange aktiv, bis
</p>

<!-- 2 Spalten: Ende --></div>

</div></div>
<!-- /Die Seite -->

<!-- Navigation unten -->
<table class="robots-nocontent style-table-zeropadding" style="width: 100%">
	<tr>
		<td class="navi-button">
			<a style="display: block" href="../../02/text/" title="Seite zurück"><span class="mirror-horizontal fas fa-play" aria-hidden=true></span></a>
		</td>
		<td class="navi-button">
			<a style="display: block" href="../../01/text/" title="Erste Seite"><span class="mirror-horizontal fas fa-fast-forward" aria-hidden=true></span></a>
		</td>
		<td class="navi-button">
			<a style="display: block" href="../../../../82/07/01/text/" title="Heft zurück"><span class="mirror-horizontal fas fa-forward" aria-hidden=true></span></a>
		</td>
		<th class="navi-button">
			<a style="display: block" href="../../text/" title="Inhaltsverzeichnis">Seite 3 von 28</a>
		</th>
		<td class="navi-button">
			<a style="display: block" href="../../../../82/10/01/text/" title="Heft vor"><span class="fas fa-forward" aria-hidden=true></span></a>
		</td>
		<td class="navi-button">
			<a style="display: block" href="../../28/text/" title="Letzte Seite"><span class="fas fa-fast-forward" aria-hidden=true></span></a>
		</td>
		<td class="navi-button">
			<a style="display: block" href="../../04/text/" title="Seite vor"><span class="fas fa-play" aria-hidden=true></span></a>
		</td>
	</tr>
</table>
<!-- /Navigation unten -->

<!-- navi-footer.php / $Date: 2023-03-11 15:22:20 +0100 (Sa, 11. Mrz 2023) $ -->

<!--********************************************************************************-->

	</div>

	<nav class="nav flex-column flex-md-row style-navbar-bottom robots-nocontent"> <!--nav-pills-->
		<a class="sm-fill nav-link" href="#top"><span title="Nach oben" class="fa fa-chevron-up" aria-hidden=true></span></a>
		<!--a class="sm-fill nav-link disabled">Text</a-->
		<a class="sm-fill nav-link" href="../">Grafik</a>
		<a class="sm-fill nav-link" href="../../thumb/text/">Miniatur&shy;bilder</a>
		<a class="sm-fill nav-link" href="../../../../../../nascom/journal/pdf/82-09.pdf" download>PDF</a>
		<a class="sm-fill nav-link" href="../../../../../../datenschutzerklaerung/">Datenschutzerklärung</a>
		<a class="sm-fill nav-link" href="../../../../../../impressum/">Impressum</a>
	</nav>

	<!--bootstrap-->
	<script src="../../../../../../cdn/bootstrap/js/bootstrap.bundle.min.js"></script>
</body>

<!-- /navi-footer.php -->
</html>

<!-- /page.php -->