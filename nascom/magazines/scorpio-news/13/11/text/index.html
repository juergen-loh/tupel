<!doctype html>
<html lang="de">

<!-- navi-head.php / $Date: 2023-03-11 15:22:20 +0100 (Sa, 11. Mrz 2023) $ -->
<head>
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<meta charset="utf-8">

	<link rel="shortcut icon" type="image/x-icon" href="../../../../../../nascom/nascom.ico">
	<link rel="icon" type="image/png" href="../../../../../../nascom/apple-touch-icon.png" sizes="32x32">
	<link rel="icon" type="image/png" href="../../../../../../nascom/apple-touch-icon.png" sizes="96x96">
	<link rel="apple-touch-icon" sizes="180x180" href="../../../../../../nascom/apple-touch-icon.png">

	<!--bootstrap-->
	<link rel="stylesheet" href="../../../../../../cdn/bootstrap/css/bootstrap.min.css">

	<!--font awesome-->
	<link rel="stylesheet" href="../../../../../../cdn/fontawesome/css/fontawesome.min.css">
	<link rel="stylesheet" href="../../../../../../cdn/fontawesome/css/solid.min.css">

	<link rel="stylesheet" type="text/css" href="../../../../../../style.css">
<!-- /navi-head.php -->

	<!-- page.php / $Date: 2024-07-13 18:55:41 +0200 (Sa, 13. Jul 2024) $ -->

	<title>Scorpio News - July&ndash;September 1987 &ndash; Volume 1. Issue 3.</title>
	<!-- Wed, 01 Jan 2025 19:19:14 GMT -->
	<meta name="keywords" content="Scor&shy;pio News, Nascom Computer, Nascom 1, Nascom 2">
	<link rel="stylesheet" type="text/css" href="../../../style.css">
<!-- navi-body.php -->
</head>

<body>
	<nav class="navbar navbar-expand-md navbar-light bg-light style-navbar-top" id="top">
	<div class="container-fluid">
		<a class="navbar-brand" href="https://jloh.de/">
			<img src="../../../../../../favicon.ico" width="32" height="32" alt="JL" title="Homepage von JÃ¼rgen Loh">
		</a>
		<button
			class="navbar-toggler"
			type="button"
			data-bs-toggle="collapse"
			data-bs-target="#navbarSupportedContent"
			aria-controls="navbarSupportedContent"
			aria-expanded="false"
			aria-label="Toggle navigation"
		>
			<span class="navbar-toggler-icon"></span>
		</button>
		<div class="collapse navbar-collapse robots-nocontent" id="navbarSupportedContent">
			<ul class="navbar-nav md-auto">
				<li class="nav-item">
					<a class="nav-link" href="../../../../../../z80-kit/">Z80-KIT</a>
				</li>
				<li class="nav-item">
					<a class="nav-link" href="../../../../../../nascom/1/">Nascom 1</a>
				</li>
				<li class="nav-item">
					<a class="nav-link" href="../../../../../../nascom/">Nascom Journal</a>
				</li>
				<li class="nav-item">
					<a class="nav-link active" href="../../../../../../nascom/magazines/issues/">Nascom Magazines</a>
				</li>
				<li class="nav-item">
					<a class="nav-link" href="../../../../../../pico/">PICO</a>
				</li>
				<li class="nav-item">
					<a class="nav-link" href="../../../../../../cpm-plus/">CP/M</a>
				</li>
				<li class="nav-item">
					<a class="nav-link" href="../../../../../../">Tupel BBS</a>
				</li>
			</ul>
		</div>
	</div>
	</nav>

	<div class="container" style="max-width: 750px; color: #000; padding: 0 15px 0; background-color: #FFF">

<!--********************************************************************************-->

<!-- /navi-body.php / $Date: 2024-12-30 14:10:13 +0100 (Mo, 30. Dez 2024) $ -->
<table class="style-table-zeropadding" style="width: 100%">
<tr>
<td>
<h1 class="h1Navi">Scor&shy;pio News</h1>
</td>
<td>&nbsp;&nbsp;</td>
<td style="vertical-align:top">
<h2 class="h2Navi">July&ndash;September 1987 &ndash; <span class="nowrap">Volume 1.</span> <span class="nowrap">Issue 3.</span></h2>
</td>
</tr>
</table>
<!-- Navigation top -->
<table class="robots-nocontent style-table-zeropadding" style="width: 100%">
	<tr>
		<td class="navi-button">
			<a style="display: block" href="../../10/text/" title="Previous page"><span class="mirror-horizontal fas fa-play" aria-hidden=true></span></a>
		</td>
		<td class="navi-button">
			<a style="display: block" href="../../01/text/" title="First page"><span class="mirror-horizontal fas fa-fast-forward" aria-hidden=true></span></a>
		</td>
		<td class="navi-button">
			<a style="display: block" href="../../../12/01/text/" title="Previous issue"><span class="mirror-horizontal fas fa-forward" aria-hidden=true></span></a>
		</td>
		<th class="navi-button">
			<a style="display: block" href="../../text/" title="Table of Contents">Page 11 of 67</a>
		</th>
		<td class="navi-button">
			<a style="display: block" href="../../../14/01/text/" title="Next issue"><span class="fas fa-forward" aria-hidden=true></span></a>
		</td>
		<td class="navi-button">
			<a style="display: block" href="../../67/text/" title="Last page"><span class="fas fa-fast-forward" aria-hidden=true></span></a>
		</td>
		<td class="navi-button">
			<a style="display: block" href="../../12/text/" title="Next page"><span class="fas fa-play" aria-hidden=true></span></a>
		</td>
	</tr>
</table>
<!-- The page -->
<div class="row" lang="en">
<div class="col-sm-12 mag-scorpio-news issue-13 page-11" style="border: 1px solid #000; padding-top: 1em; padding-bottom: 1em;" lang="en" id="page">
<!-- 3 columns: start 2 --><div class="row"><div class="col-sm-8">
<h2 id="article1">
Disk Formats and CP/M Disk routines &ndash; Part 3
</h2>
<!-- 3 columns: change --></div><div class="col-sm-4">
<h3 class="author" style="text-align: right">
by M.W.T. Waters
</h3>
<!-- 3 columns: end --></div></div>
<!-- 1 column: start --><div>
<h3>
Disk Parameter Headers
</h3>
<h3>
The CP/M&nbsp;2.2 DPH
</h3>
<p>
A DPH for CP/M&nbsp;2.2 is a table of eight 16 bit words broken up as follows:
</p>
<table class="indent2" style="width: 70%">
<tr><td>DPH:</td><td>XLT</td><td>; Translate table address</td></tr>
<tr><td></td><td>0000</td><td>; 6 bytes scratchpad for BDOS use</td></tr>
<tr><td></td><td>0000</td><td></td></tr>
<tr><td></td><td>0000</td><td></td></tr>
<tr><td></td><td>DIRBUF</td><td>; Address of a buffer used<br>
								; for reading directory information</td></tr>
<tr><td></td><td>DPB</td><td>; Disk Parameter Block Address</td></tr>
<tr><td></td><td>CSV</td><td>; Checksum Vector address</td></tr>
<tr><td></td><td>ALV</td><td>; Allocation Vector address</td></tr>
</table>
<p>
Note that CP/M&nbsp;1.4 doesn&rsquo;t use DPH&rsquo;s and that the DPH&rsquo;s for CP/M&nbsp;3 are
longer.
</p>
<p>
The BIOS has a DPH for each drive supported by the system. When a drive is
logged in, the BIOS returns the address of the appropriate DPH to the BDOS. The
BDOS then uses the DPH to locate any remaining data structure that it requires.
</p>
<p>
The first entry is the the address of a sector translate table which the BIOS
will use to convert from logical to physical sector numbers before accessing the
disk. If no sector translation is required, this word will contain zero.
Sector translation is discussed in some detail elsewhere so all that will be
said at this point is that CP/M&nbsp;2.2 only allows for translation of 128 byte
sectors. If sector translation is required on systems using sector sizes of
more than 128 bytes, XLT must be set to zero and the BIOS should do the
translation separately. CP/M&nbsp;3 doesn&rsquo;t suffer from this limitation as all disk
transfers and sector translation are done in terms of physical disk sectors.
</p>
<p>
The next 6 bytes are reserved for use by the BDOS as workspace. Their
initial value is immaterial.
</p>
<p>
DIRBUF is the address of a buffer used by the BDOS and BIOS when reading
directory information. This buffer is one physical sector long (512 bytes for
Gemini DDDS, QDDS and QDSS formats, 128 bytes for SDDS format) and may be shared
by all drives in the system. CP/M&nbsp;1.4 is different in that it uses the default
buffer at address 80H for this purpose. CP/M&nbsp;3 buffers the directory records
differently end consequently CP/M&nbsp;3 does do not contain this field.
</p>
<p>
DPB is the address of a Disk Parameter Block for the drive concerned. A
separate DPB is required for each disk format handled. DPH&rsquo;s for drives using
the disk format may all address the same DPB. The DPB is explained in full
later.
</p>
<h3>
The Checksum Vector
</h3>
<p>
CSV is the address of a table that CP/M uses to check whether a disk has
been changed. The table is used to store a checksum byte that uniquely
identifies a directory record (128 bytes containing 4 directory entries). A
good definition of a checksum is, in this case, a single byte which is derived
from a block of data and whose value is unique to that block. As far as we are
concerned, a block is 4 directory entries totalling 128 bytes (i.e. one CP/M
record) and the checksum byte is obtained by adding together all of the bytes in
the record, ignoring overflow, to produce a total. This total, and the totals
for the remaining directory records are stored in a part of the BIOS known as
the checksum vector and its address is given as CSV in the DPH. There is a
checksum vector for each drive supported by the system. The length of each
vector depends upon the number of directory entries. Since the checksum applies
</p>
<!-- 1 column: end --></div>

</div>
</div>
<!-- /The page -->
<!-- Navigation bottom -->
<table class="robots-nocontent style-table-zeropadding" style="width: 100%">
	<tr>
		<td class="navi-button">
			<a style="display: block" href="../../10/text/" title="Previous page"><span class="mirror-horizontal fas fa-play" aria-hidden=true></span></a>
		</td>
		<td class="navi-button">
			<a style="display: block" href="../../01/text/" title="First page"><span class="mirror-horizontal fas fa-fast-forward" aria-hidden=true></span></a>
		</td>
		<td class="navi-button">
			<a style="display: block" href="../../../12/01/text/" title="Previous issue"><span class="mirror-horizontal fas fa-forward" aria-hidden=true></span></a>
		</td>
		<th class="navi-button">
			<a style="display: block" href="../../text/" title="Table of Contents">Page 11 of 67</a>
		</th>
		<td class="navi-button">
			<a style="display: block" href="../../../14/01/text/" title="Next issue"><span class="fas fa-forward" aria-hidden=true></span></a>
		</td>
		<td class="navi-button">
			<a style="display: block" href="../../67/text/" title="Last page"><span class="fas fa-fast-forward" aria-hidden=true></span></a>
		</td>
		<td class="navi-button">
			<a style="display: block" href="../../12/text/" title="Next page"><span class="fas fa-play" aria-hidden=true></span></a>
		</td>
	</tr>
</table>

<!-- navi-footer.php / $Date: 2023-03-11 15:22:20 +0100 (Sa, 11. Mrz 2023) $ -->

<!--********************************************************************************-->

	</div>

	<nav class="nav flex-column flex-md-row style-navbar-bottom robots-nocontent"> <!--nav-pills-->
		<a class="sm-fill nav-link" href="#top"><span title="Nach oben" class="fa fa-chevron-up" aria-hidden=true></span></a>
		<a class="sm-fill nav-link" href="../">Graphic</a>
		<a class="sm-fill nav-link" href="https://80bus.co.uk.mirror.jloh.de/publications/magazines/Scorpio_News_1_3.pdf#page=11" target="_blank">PDF</a>
		<a class="sm-fill nav-link" href="../../../../../../datenschutzerklaerung/">Privacy Statement</a>
		<a class="sm-fill nav-link" href="../../../../../../impressum/">Imprint</a>
	</nav>

	<!--bootstrap-->
	<script src="../../../../../../cdn/bootstrap/js/bootstrap.bundle.min.js"></script>
</body>

<!-- /navi-footer.php -->
</html>

<!-- /page.php -->