<!doctype html>
<html lang="de">

<!-- navi-head.php / $Date: 2025-01-05 17:01:36 +0100 (So, 05. Jan 2025) $ -->
<head>
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<meta charset="utf-8">

	<link rel="shortcut icon" type="image/x-icon" href="../../../../../../nascom/nascom.ico">
	<link rel="icon" type="image/png" href="../../../../../../nascom/apple-touch-icon.png" sizes="32x32">
	<link rel="icon" type="image/png" href="../../../../../../nascom/apple-touch-icon.png" sizes="96x96">
	<link rel="apple-touch-icon" sizes="180x180" href="../../../../../../nascom/apple-touch-icon.png">

	<!--bootstrap-->
	<link rel="stylesheet" href="../../../../../../cdn/bootstrap/css/bootstrap.min.css">

	<!--font awesome-->
	<link rel="stylesheet" href="../../../../../../cdn/fontawesome/css/fontawesome.min.css">
	<link rel="stylesheet" href="../../../../../../cdn/fontawesome/css/solid.min.css">

	<link rel="stylesheet" type="text/css" href="../../../../../../style.css">
	<link rel="canonical" href="https://tupel.jloh.de/nascom/magazines/scorpio-news/14/15/text/">
<!-- /navi-head.php -->

	<!-- page.php / $Date: 2024-07-13 18:55:41 +0200 (Sa, 13. Jul 2024) $ -->

	<title>Scorpio News - October&ndash;December 1987 &ndash; Volume 1. Issue 4.</title>
	<!-- Sun, 05 Jan 2025 16:01:37 GMT -->
	<meta name="keywords" content="Scor&shy;pio News, Nascom Computer, Nascom 1, Nascom 2">
	<link rel="stylesheet" type="text/css" href="../../../style.css">
<!-- navi-body.php -->
</head>

<body>
	<nav class="navbar navbar-expand-md navbar-light bg-light style-navbar-top" id="top">
	<div class="container-fluid">
		<a class="navbar-brand" href="https://jloh.de/">
			<img src="../../../../../../favicon.ico" width="32" height="32" alt="JL" title="Homepage von JÃ¼rgen Loh">
		</a>
		<button
			class="navbar-toggler"
			type="button"
			data-bs-toggle="collapse"
			data-bs-target="#navbarSupportedContent"
			aria-controls="navbarSupportedContent"
			aria-expanded="false"
			aria-label="Toggle navigation"
		>
			<span class="navbar-toggler-icon"></span>
		</button>
		<div class="collapse navbar-collapse robots-nocontent" id="navbarSupportedContent">
			<ul class="navbar-nav md-auto">
				<li class="nav-item">
					<a class="nav-link" href="../../../../../../z80-kit/">Z80-KIT</a>
				</li>
				<li class="nav-item">
					<a class="nav-link" href="../../../../../../nascom/1/">Nascom 1</a>
				</li>
				<li class="nav-item">
					<a class="nav-link" href="../../../../../../nascom/">Nascom Journal</a>
				</li>
				<li class="nav-item">
					<a class="nav-link active" href="../../../../../../nascom/magazines/issues/">Nascom Magazines</a>
				</li>
				<li class="nav-item">
					<a class="nav-link" href="../../../../../../pico/">PICO</a>
				</li>
				<li class="nav-item">
					<a class="nav-link" href="../../../../../../cpm-plus/">CP/M</a>
				</li>
				<li class="nav-item">
					<a class="nav-link" href="../../../../../../">Tupel BBS</a>
				</li>
			</ul>
		</div>
	</div>
	</nav>

	<div class="container" style="max-width: 750px; color: #000; padding: 0 15px 0; background-color: #FFF">

<!--********************************************************************************-->

<!-- /navi-body.php / $Date: 2024-12-30 14:10:13 +0100 (Mo, 30. Dez 2024) $ -->
<table class="style-table-zeropadding" style="width: 100%">
<tr>
<td>
<h1 class="h1Navi">Scor&shy;pio News</h1>
</td>
<td>&nbsp;&nbsp;</td>
<td style="vertical-align:top">
<h2 class="h2Navi">October&ndash;December 1987 &ndash; <span class="nowrap">Volume 1.</span> <span class="nowrap">Issue 4.</span></h2>
</td>
</tr>
</table>
<!-- Navigation top -->
<table class="robots-nocontent style-table-zeropadding" style="width: 100%">
	<tr>
		<td class="navi-button">
			<a style="display: block" href="../../14/text/" title="Previous page"><span class="mirror-horizontal fas fa-play" aria-hidden=true></span></a>
		</td>
		<td class="navi-button">
			<a style="display: block" href="../../01/text/" title="First page"><span class="mirror-horizontal fas fa-fast-forward" aria-hidden=true></span></a>
		</td>
		<td class="navi-button">
			<a style="display: block" href="../../../13/01/text/" title="Previous issue"><span class="mirror-horizontal fas fa-forward" aria-hidden=true></span></a>
		</td>
		<th class="navi-button">
			<a style="display: block" href="../../text/" title="Table of Contents">Page 15 of 55</a>
		</th>
		<td class="navi-button">
			<a style="display: block" href="../../../21/01/text/" title="Next issue"><span class="fas fa-forward" aria-hidden=true></span></a>
		</td>
		<td class="navi-button">
			<a style="display: block" href="../../55/text/" title="Last page"><span class="fas fa-fast-forward" aria-hidden=true></span></a>
		</td>
		<td class="navi-button">
			<a style="display: block" href="../../16/text/" title="Next page"><span class="fas fa-play" aria-hidden=true></span></a>
		</td>
	</tr>
</table>
<!-- The page -->
<div class="row" lang="en">
<div class="col-sm-12 mag-scorpio-news issue-14 page-15" style="border: 1px solid #000; padding-top: 1em; padding-bottom: 1em;" lang="en" id="page">
<!-- 3 columns: start 2 --><div class="row"><div class="col-sm-8">
<h2 id="article1">
Disk Formats and CP/M Disk Routines &ndash; Part 4
</h2>
<!-- 3 columns: change --></div><div class="col-sm-4">
<h3 class="author">
by M.W.T. Waters
</h3>
<!-- 3 columns: end --></div></div>
<!-- 1 column: start --><div>
<p>
This is the final part in this series. But first of all here is a correction to the
<a href="../../../13/11/text/#article1">last part</a>,
part 3, published in Volume&nbsp;1, Issue&nbsp;3, page&nbsp;11:
</p>
<p>
In the article, the author had a brainstorm and said that the directory buffer (DIRBUF) under
CP/M&nbsp;2.2 is one physical sector long. This, of course, it quite incorrect. The length of this
buffer is one logical record (128 bytes) long. The description of the directory buffers controlled
by the Buffer Control Blocks under CP/M Plus IS correct, however. CP/M Plus, as stated in the
article, controls buffers, each of which is one physical sector long.
</p>
<h3>
CP/M&nbsp;3 Buffer Control Block format
</h3>
<p>
The format of a Buffer Control Block is given below. The format is identical for both directory
and data BCB&rsquo;s
</p>
<table class="bcb-format">
<tr><td>DRV</td><td>;</td><td>8 bits</td><td>&ndash;</td><td>Source drive of buffered data</td></tr>
<tr><td>REC</td><td>;</td><td>24&nbsp;bits</td><td>&ndash;</td><td>Record Position on disk</td></tr>
<tr><td>WFLG</td><td>;</td><td>8 bits</td><td>&ndash;</td><td>Flag indicating unwritten data</td></tr>
<tr><td>00</td><td>;</td><td>8 bits</td><td>&ndash;</td><td>BDOS scratchpad</td></tr>
<tr><td>TRACK</td><td>;</td><td>16 bits</td><td>&ndash;</td><td>Track number for buffered data</td></tr>
<tr><td>SECTOR</td><td>;</td><td>16 bits</td><td>&ndash;</td><td>Sector number for buffered data</td></tr>
<tr><td>BUFFAD</td><td>;</td><td>16 bits</td><td>&ndash;</td><td>Address of buffer for this BCB</td></tr>
<tr><td>BANK</td><td>;</td><td>8 bits</td><td>&ndash;</td><td>Bank no of buffer for this BCB</td></tr>
<tr><td>LINK</td><td>;</td><td>16 bits</td><td>&ndash;</td><td>Address of next BCB in list</td></tr>
</table>
<p>
DRV indicates the source drive from which the contents of the buffer located at BUFFAD was
obtained or, alternatively, the destination drive for the data in the buffer.
</p>
<p>
REC contains the record position of the current buffer contents. This figure is an absolute
sector number relative to the first sector in the data tracks of the disk. For example
the first sector in block 0 (i.e. the first directory sector) is numbered zero, the next is number
one and so on for all data blocks on the disk.
</p>
<p>
WFLG is set by the BDOS when the buffer associated with the BCB contained new data that has yet
to be written to the disk. When the data has been written, this flag is then set to zero by the
BDOS.
</p>
<p>
TRACK is the physical track location of the contents of the buffer.
</p>
<p>
SECTOR contains the physical sector location of the contents of the buffer.
</p>
<p>
BUFFAD contains a 16 bit address showing the location of the physical sector buffer associated
with this BCB.
</p>
<p>
BANK contains the memory bank umber holding the buffer. Naturally, this field is not present
in non-banked systems.
</p>
<p>
LINK contains the address of the next BCB in the linked list. If this the last BCB in the
list, this field will contain zero. This field isn&rsquo;t present on non-banked systems as only one
buffer and associated BCB existm
</p>
<p>
Having covered the DPH, XDPH and associated data structures, we can now examine the Disk
Parameter Block detail.
</p>
<h3>
Disk Parameter Blocks
</h3>
<h3>
The CP/M&nbsp;2.2 DPB
</h3>
<p>
The disk parameter blocks in the BIOS tell the BDOS all it needs to know about the physical
characteristics of the disk. The CP/M&nbsp;2.2 DPB for a Gemini QDDS format disk looks like this:
</p>
<!-- 1 column: end --></div>

</div>
</div>
<!-- /The page -->
<!-- Navigation bottom -->
<table class="robots-nocontent style-table-zeropadding" style="width: 100%">
	<tr>
		<td class="navi-button">
			<a style="display: block" href="../../14/text/" title="Previous page"><span class="mirror-horizontal fas fa-play" aria-hidden=true></span></a>
		</td>
		<td class="navi-button">
			<a style="display: block" href="../../01/text/" title="First page"><span class="mirror-horizontal fas fa-fast-forward" aria-hidden=true></span></a>
		</td>
		<td class="navi-button">
			<a style="display: block" href="../../../13/01/text/" title="Previous issue"><span class="mirror-horizontal fas fa-forward" aria-hidden=true></span></a>
		</td>
		<th class="navi-button">
			<a style="display: block" href="../../text/" title="Table of Contents">Page 15 of 55</a>
		</th>
		<td class="navi-button">
			<a style="display: block" href="../../../21/01/text/" title="Next issue"><span class="fas fa-forward" aria-hidden=true></span></a>
		</td>
		<td class="navi-button">
			<a style="display: block" href="../../55/text/" title="Last page"><span class="fas fa-fast-forward" aria-hidden=true></span></a>
		</td>
		<td class="navi-button">
			<a style="display: block" href="../../16/text/" title="Next page"><span class="fas fa-play" aria-hidden=true></span></a>
		</td>
	</tr>
</table>

<!-- navi-footer.php / $Date: 2023-03-11 15:22:20 +0100 (Sa, 11. Mrz 2023) $ -->

<!--********************************************************************************-->

	</div>

	<nav class="nav flex-column flex-md-row style-navbar-bottom robots-nocontent"> <!--nav-pills-->
		<a class="sm-fill nav-link" href="#top"><span title="Nach oben" class="fa fa-chevron-up" aria-hidden=true></span></a>
		<a class="sm-fill nav-link" href="../">Graphic</a>
		<a class="sm-fill nav-link" href="https://80bus.co.uk.mirror.jloh.de/publications/magazines/Scorpio_News_1_4.pdf#page=15" target="_blank">PDF</a>
		<a class="sm-fill nav-link" href="../../../../../../datenschutzerklaerung/">Privacy Statement</a>
		<a class="sm-fill nav-link" href="../../../../../../impressum/">Imprint</a>
	</nav>

	<!--bootstrap-->
	<script src="../../../../../../cdn/bootstrap/js/bootstrap.bundle.min.js"></script>
</body>

<!-- /navi-footer.php -->
</html>

<!-- /page.php -->