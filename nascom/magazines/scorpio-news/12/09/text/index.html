<!doctype html>
<html lang="de">

<!-- navi-head.php / $Date: 2025-01-05 17:13:18 +0100 (So, 05. Jan 2025) $ -->
<head>
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<meta charset="utf-8">

	<link rel="shortcut icon" type="image/x-icon" href="../../../../../../nascom/nascom.ico">
	<link rel="icon" type="image/png" href="../../../../../../nascom/apple-touch-icon.png" sizes="32x32">
	<link rel="icon" type="image/png" href="../../../../../../nascom/apple-touch-icon.png" sizes="96x96">
	<link rel="apple-touch-icon" sizes="180x180" href="../../../../../../nascom/apple-touch-icon.png">

	<!--bootstrap-->
	<link rel="stylesheet" href="../../../../../../cdn/bootstrap/css/bootstrap.min.css">

	<!--font awesome-->
	<link rel="stylesheet" href="../../../../../../cdn/fontawesome/css/fontawesome.min.css">
	<link rel="stylesheet" href="../../../../../../cdn/fontawesome/css/solid.min.css">

	<link rel="stylesheet" type="text/css" href="../../../../../../style.css">
	<link rel="canonical" href="https://tupel.jloh.de/nascom/magazines/scorpio-news/12/09/text/">
<!-- /navi-head.php -->

	<!-- page.php / $Date: 2024-07-13 18:55:41 +0200 (Sa, 13. Jul 2024) $ -->

	<title>Scorpio News - April&ndash;June 1987 &ndash; Volume 1. Issue 2.</title>
	<!-- Sun, 16 Mar 2025 14:14:42 GMT -->
	<meta name="keywords" content="Scor&shy;pio News, Nascom Computer, Nascom 1, Nascom 2">
	<link rel="stylesheet" type="text/css" href="../../../style.css">
<!-- navi-body.php -->
</head>

<body>
	<nav class="navbar navbar-expand-md navbar-light bg-light style-navbar-top" id="top">
	<div class="container-fluid">
		<a class="navbar-brand" href="https://jloh.de/">
			<img src="../../../../../../favicon.ico" width="32" height="32" alt="JL" title="Homepage von JÃ¼rgen Loh">
		</a>
		<button
			class="navbar-toggler"
			type="button"
			data-bs-toggle="collapse"
			data-bs-target="#navbarSupportedContent"
			aria-controls="navbarSupportedContent"
			aria-expanded="false"
			aria-label="Toggle navigation"
		>
			<span class="navbar-toggler-icon"></span>
		</button>
		<div class="collapse navbar-collapse robots-nocontent" id="navbarSupportedContent">
			<ul class="navbar-nav md-auto">
				<li class="nav-item">
					<a class="nav-link" href="../../../../../../z80-kit/">Z80-KIT</a>
				</li>
				<li class="nav-item">
					<a class="nav-link" href="../../../../../../nascom/1/">Nascom 1</a>
				</li>
				<li class="nav-item">
					<a class="nav-link" href="../../../../../../nascom/">Nascom Journal</a>
				</li>
				<li class="nav-item">
					<a class="nav-link active" href="../../../../../../nascom/magazines/issues/">Nascom Magazines</a>
				</li>
				<li class="nav-item">
					<a class="nav-link" href="../../../../../../pico/">PICO</a>
				</li>
				<li class="nav-item">
					<a class="nav-link" href="../../../../../../cpm-plus/">CP/M</a>
				</li>
				<li class="nav-item">
					<a class="nav-link" href="../../../../../../">Tupel BBS</a>
				</li>
			</ul>
		</div>
	</div>
	</nav>

	<div class="container" style="max-width: 750px; color: #000; padding: 0 15px 0; background-color: #FFF">

<!--********************************************************************************-->

<!-- /navi-body.php / $Date: 2025-03-16 15:14:42 +0100 (So, 16. Mrz 2025) $ -->
<table class="style-table-zeropadding" style="width: 100%">
<tr>
<td>
<h1 class="h1Navi">Scor&shy;pio News</h1>
</td>
<td>&nbsp;&nbsp;</td>
<td style="vertical-align:top">
<h2 class="h2Navi">April&ndash;June 1987 &ndash; <span class="nowrap">Volume 1.</span> <span class="nowrap">Issue 2.</span></h2>
</td>
</tr>
</table>
<!-- Navigation top -->
<table class="robots-nocontent style-table-zeropadding" style="width: 100%">
	<tr>
		<td class="navi-button">
			<a style="display: block" href="../../08/text/" title="Previous page"><span class="mirror-horizontal fas fa-play" aria-hidden=true></span></a>
		</td>
		<td class="navi-button">
			<a style="display: block" href="../../01/text/" title="First page"><span class="mirror-horizontal fas fa-fast-forward" aria-hidden=true></span></a>
		</td>
		<td class="navi-button">
			<a style="display: block" href="../../../11/01/text/" title="Previous issue"><span class="mirror-horizontal fas fa-forward" aria-hidden=true></span></a>
		</td>
		<th class="navi-button">
			<a style="display: block" href="../../text/" title="Table of Contents">Page 9 of 51</a>
		</th>
		<td class="navi-button">
			<a style="display: block" href="../../../13/01/text/" title="Next issue"><span class="fas fa-forward" aria-hidden=true></span></a>
		</td>
		<td class="navi-button">
			<a style="display: block" href="../../51/text/" title="Last page"><span class="fas fa-fast-forward" aria-hidden=true></span></a>
		</td>
		<td class="navi-button">
			<a style="display: block" href="../../10/text/" title="Next page"><span class="fas fa-play" aria-hidden=true></span></a>
		</td>
	</tr>
</table>
<!-- The page -->
<div class="row" lang="en">
<div class="col-sm-12 mag-scorpio-news issue-12 page-09" style="border: 1px solid #000; padding-top: 1em; padding-bottom: 1em;" lang="en" id="page">
<!-- 2() columns: start --><div class="row"><div class="col-sm-6">
<h2 id="article1">
The Z80 CTC
</h2>
<!-- 2 columns: change --></div><div class="col-sm-6">
<h3 class="author">
by Rory O&rsquo;Farrell
</h3>
<!-- 2 columns: end --></div></div>
<!-- 1 column: start --><div>
<p>
Some time ago <a href="../../14/text/#ref1">[1]</a> I wrote on aspects of the
<a href="../../../../80-bus-news/21/06/text/#article1">Z80 microcomputer&rsquo;s interrupt structure</a>.
In the article, I dealt mainly with the Z80 <!-- External Link --><a href="https://www.zilog.com/docs/z80/ps0180.pdf" title="External Link: Z80 PIO" target="_blank" rel="noreferrer">PIO</a><!-- /External Link -->. Since then there
have been many requests for another article to deal with the other Z80 family
chips. In this and a subsequent article it is my intention to cover the
intricacies of programming the following chips:
</p>
<!-- 1 column: end --></div>
<p></p>
<!-- 4 columns: start --><div class="row"><div class="col-sm-3">
<!-- 4 columns: change 3 --></div><div class="col-sm-9">
<table>
<tr><td>The <!-- External Link --><a href="https://www.zilog.com/docs/z80/ps0181.pdf" title="External Link: Z80 CTC" target="_blank" rel="noreferrer">CTC</a><!-- /External Link -->
</td><td>(Counter Timer Circuit)</td></tr>
<tr><td>The <!-- External Link --><a href="https://www.zilog.com/docs/z80/ps0183.pdf" title="External Link: Z80 SIO" target="_blank" rel="noreferrer">SIO</a><!-- /External Link --></td><td>(Serial Input/&#x200b;Output Controller)</td></tr>
<tr><td>The <!-- External Link --><a href="https://datasheet.datasheetarchive.com/originals/scans/Scans-97/DSAIHSC00072076.pdf" title="External Link: Z80 DART" target="_blank" rel="noreferrer">DART</a><!-- /External Link -->
</td><td>(Dual Asynchronous Receiver/&#x200b;Transmitter)</td></tr>
</table>
<!-- 4 columns: end --></div></div>
<p></p>
<!-- 1 column: start --><div>
<p>
Fortunately, the DART is a reduced specification SIO, providing only the
asynchronous facilities, so for brevity I will simply refer to the SIO, and in
general the DART will also be implied.
</p>
<p>
For ease of understanding, I propose to discuss the CTC/&#x200b;SIO pair as used on the
<!-- External Link --><a href="https://80bus.co.uk.mirror.jloh.de/pages/map80/MAP80_CPU.htm" title="External Link: MAP80 CPU" target="_blank" rel="noreferrer">MAP CPU</a><!-- /External Link -->
 and
<!-- External Link --><a href="https://80bus.co.uk.mirror.jloh.de/pages/map80/MAP80_MPI.htm" title="External Link: MAP80 MPI" target="_blank" rel="noreferrer">MAP MPI</a><!-- /External Link -->
 boards.
On these boards the CTC/&#x200b;SIO group provide a most
powerful, fully programmable, serial input/&#x200b;output unit. This is not the only
possible use for these chips, but it will serve well as an introduction, besides
being the most common configuration for them.
</p>
<p>
Serial I/O interconnections have been very adequately dealt with in
<a href="../../14/text/#ref2">[2]</a> and
<a href="../../14/text/#ref3">[3]</a>,
and interested readers are referred to those articles for detail coverage of the
subject. For the newcomer, it is appropriate to give a minimum explanation to
set the scene. A Serial I/O chip is one which is given a byte of data and
which squirts it out bit by bit onto a pair of wires &ndash; rather like a lump of
dough being fed through a spaghetti maker &ndash; our new improved modified spaghetti
maker which makes only one strand at a time! That is the act of transmission.
Such a chip is also capable of receiving the individual bite of data and
reassembling them into a byte &ndash; scrunching up all the fresh spaghetti to end up
with a lump of dough again. There are other concerns, which need not affect us
here, such as level shifting from TTL levels (0-5&nbsp;volt) to RS232 levels
(+/&ndash;&nbsp;12&nbsp;volt), as these problems are dealt with in the articles cited.
</p>
<p>
If we imagine that we have a spaghetti maker at one end of a table manufacturing
a single strand of spaghetti, and a reverse spaghetti maker at the other, we can
hove pieces of dough from one end of the table to the other by feeding the
output of one machine into the input of the other. It is easy to see that if
the generator makes the spaghetti faster than the other machine consumes it, we
will soon have a big pile of spaghetti on the table. If the consuming machine
consumes faster than the maker, then the strand of spaghetti keeps getting
pulled tight end breaking. So it becomes obvious that both machines must work
at the same pace. Similarly when transmitting data from one serial device to
another, they must both work at the same rate, or in jargon, be &lsquo;clocked at the
same rate&rsquo;. One of the major problems with serial communications is finding the
rate of transmission or reception, loosely called the &lsquo;baudrate&rsquo;. We will
consider the use of a CTC to provide differing baudrates or &lsquo;clocks&rsquo; for an SIO.
</p>
<p>
The CTC chip is a 28 pin member of the Z80 family. It comprises four channels,
which are substantially the same. Addressed as four I/O ports, one for each
channel, it can return an interrupt vector from each channel on the occurrence
of certain conditions, which criteria can be programmed into that channel. For
ease of reference, we number the channels from 0 to 3. Channel 0 differs from
the others in that it remembers the interrupt vector for channel 0, and the
onboard circuitry of the CTC is able to modify this interrupt vector to indicate
the interrupting channel. This we will deal with shortly. Channel 3 differs
from the other channels in that it (due to limitations of pin numbers) cannot
output pulses, it can only count them.
</p>
<p>
The manual for the CTC
<a href="../../14/text/#ref4">[4]</a> says that the CTC can be configured as a counter or
as a timer. This is true, but confusing. I find the following picture easier
to grasp: each channel of the CTC is a counter. The channel can be set up to
count pulses arriving on the input pin for that channel (CLocK/&#x200b;TRiGger input,
CLK/&#x200b;TRGn, where n refers to the channel number), or to count pulses arriving
</p>
<!-- 1 column: end --></div>

</div>
</div>
<!-- /The page -->
<!-- Navigation bottom -->
<table class="robots-nocontent style-table-zeropadding" style="width: 100%">
	<tr>
		<td class="navi-button">
			<a style="display: block" href="../../08/text/" title="Previous page"><span class="mirror-horizontal fas fa-play" aria-hidden=true></span></a>
		</td>
		<td class="navi-button">
			<a style="display: block" href="../../01/text/" title="First page"><span class="mirror-horizontal fas fa-fast-forward" aria-hidden=true></span></a>
		</td>
		<td class="navi-button">
			<a style="display: block" href="../../../11/01/text/" title="Previous issue"><span class="mirror-horizontal fas fa-forward" aria-hidden=true></span></a>
		</td>
		<th class="navi-button">
			<a style="display: block" href="../../text/" title="Table of Contents">Page 9 of 51</a>
		</th>
		<td class="navi-button">
			<a style="display: block" href="../../../13/01/text/" title="Next issue"><span class="fas fa-forward" aria-hidden=true></span></a>
		</td>
		<td class="navi-button">
			<a style="display: block" href="../../51/text/" title="Last page"><span class="fas fa-fast-forward" aria-hidden=true></span></a>
		</td>
		<td class="navi-button">
			<a style="display: block" href="../../10/text/" title="Next page"><span class="fas fa-play" aria-hidden=true></span></a>
		</td>
	</tr>
</table>

<!-- navi-footer.php / $Date: 2023-03-11 15:22:20 +0100 (Sa, 11. Mrz 2023) $ -->

<!--********************************************************************************-->

	</div>

	<nav class="nav flex-column flex-md-row style-navbar-bottom robots-nocontent"> <!--nav-pills-->
		<a class="sm-fill nav-link" href="#top"><span title="Nach oben" class="fa fa-chevron-up" aria-hidden=true></span></a>
		<a class="sm-fill nav-link" href="../">Graphic</a>
		<a class="sm-fill nav-link" href="https://80bus.co.uk.mirror.jloh.de/publications/magazines/Scorpio_News_1_2.pdf#page=9" target="_blank">PDF</a>
		<a class="sm-fill nav-link" href="../../../../../../datenschutzerklaerung/">Privacy Statement</a>
		<a class="sm-fill nav-link" href="../../../../../../impressum/">Imprint</a>
	</nav>

	<!--bootstrap-->
	<script src="../../../../../../cdn/bootstrap/js/bootstrap.bundle.min.js"></script>
</body>

<!-- /navi-footer.php -->
</html>

<!-- /page.php -->