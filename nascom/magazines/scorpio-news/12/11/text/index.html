<!doctype html>
<html lang="de">

<!-- navi-head.php / $Date: 2025-01-05 17:13:18 +0100 (So, 05. Jan 2025) $ -->
<head>
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<meta charset="utf-8">

	<link rel="shortcut icon" type="image/x-icon" href="../../../../../../nascom/nascom.ico">
	<link rel="icon" type="image/png" href="../../../../../../nascom/apple-touch-icon.png" sizes="32x32">
	<link rel="icon" type="image/png" href="../../../../../../nascom/apple-touch-icon.png" sizes="96x96">
	<link rel="apple-touch-icon" sizes="180x180" href="../../../../../../nascom/apple-touch-icon.png">

	<!--bootstrap-->
	<link rel="stylesheet" href="../../../../../../cdn/bootstrap/css/bootstrap.min.css">

	<!--font awesome-->
	<link rel="stylesheet" href="../../../../../../cdn/fontawesome/css/fontawesome.min.css">
	<link rel="stylesheet" href="../../../../../../cdn/fontawesome/css/solid.min.css">

	<link rel="stylesheet" type="text/css" href="../../../../../../style.css">
	<link rel="canonical" href="https://tupel.jloh.de/nascom/magazines/scorpio-news/12/11/text/">
<!-- /navi-head.php -->

	<!-- page.php / $Date: 2024-07-13 18:55:41 +0200 (Sa, 13. Jul 2024) $ -->

	<title>Scorpio News - April&ndash;June 1987 &ndash; Volume 1. Issue 2.</title>
	<!-- Sun, 16 Mar 2025 14:14:42 GMT -->
	<meta name="keywords" content="Scor&shy;pio News, Nascom Computer, Nascom 1, Nascom 2">
	<link rel="stylesheet" type="text/css" href="../../../style.css">
<!-- navi-body.php -->
</head>

<body>
	<nav class="navbar navbar-expand-md navbar-light bg-light style-navbar-top" id="top">
	<div class="container-fluid">
		<a class="navbar-brand" href="https://jloh.de/">
			<img src="../../../../../../favicon.ico" width="32" height="32" alt="JL" title="Homepage von JÃ¼rgen Loh">
		</a>
		<button
			class="navbar-toggler"
			type="button"
			data-bs-toggle="collapse"
			data-bs-target="#navbarSupportedContent"
			aria-controls="navbarSupportedContent"
			aria-expanded="false"
			aria-label="Toggle navigation"
		>
			<span class="navbar-toggler-icon"></span>
		</button>
		<div class="collapse navbar-collapse robots-nocontent" id="navbarSupportedContent">
			<ul class="navbar-nav md-auto">
				<li class="nav-item">
					<a class="nav-link" href="../../../../../../z80-kit/">Z80-KIT</a>
				</li>
				<li class="nav-item">
					<a class="nav-link" href="../../../../../../nascom/1/">Nascom 1</a>
				</li>
				<li class="nav-item">
					<a class="nav-link" href="../../../../../../nascom/">Nascom Journal</a>
				</li>
				<li class="nav-item">
					<a class="nav-link active" href="../../../../../../nascom/magazines/issues/">Nascom Magazines</a>
				</li>
				<li class="nav-item">
					<a class="nav-link" href="../../../../../../pico/">PICO</a>
				</li>
				<li class="nav-item">
					<a class="nav-link" href="../../../../../../cpm-plus/">CP/M</a>
				</li>
				<li class="nav-item">
					<a class="nav-link" href="../../../../../../">Tupel BBS</a>
				</li>
			</ul>
		</div>
	</div>
	</nav>

	<div class="container" style="max-width: 750px; color: #000; padding: 0 15px 0; background-color: #FFF">

<!--********************************************************************************-->

<!-- /navi-body.php / $Date: 2025-03-16 15:14:42 +0100 (So, 16. Mrz 2025) $ -->
<table class="style-table-zeropadding" style="width: 100%">
<tr>
<td>
<h1 class="h1Navi">Scor&shy;pio News</h1>
</td>
<td>&nbsp;&nbsp;</td>
<td style="vertical-align:top">
<h2 class="h2Navi">April&ndash;June 1987 &ndash; <span class="nowrap">Volume 1.</span> <span class="nowrap">Issue 2.</span></h2>
</td>
</tr>
</table>
<!-- Navigation top -->
<table class="robots-nocontent style-table-zeropadding" style="width: 100%">
	<tr>
		<td class="navi-button">
			<a style="display: block" href="../../10/text/" title="Previous page"><span class="mirror-horizontal fas fa-play" aria-hidden=true></span></a>
		</td>
		<td class="navi-button">
			<a style="display: block" href="../../01/text/" title="First page"><span class="mirror-horizontal fas fa-fast-forward" aria-hidden=true></span></a>
		</td>
		<td class="navi-button">
			<a style="display: block" href="../../../11/01/text/" title="Previous issue"><span class="mirror-horizontal fas fa-forward" aria-hidden=true></span></a>
		</td>
		<th class="navi-button">
			<a style="display: block" href="../../text/" title="Table of Contents">Page 11 of 51</a>
		</th>
		<td class="navi-button">
			<a style="display: block" href="../../../13/01/text/" title="Next issue"><span class="fas fa-forward" aria-hidden=true></span></a>
		</td>
		<td class="navi-button">
			<a style="display: block" href="../../51/text/" title="Last page"><span class="fas fa-fast-forward" aria-hidden=true></span></a>
		</td>
		<td class="navi-button">
			<a style="display: block" href="../../12/text/" title="Next page"><span class="fas fa-play" aria-hidden=true></span></a>
		</td>
	</tr>
</table>
<!-- The page -->
<div class="row" lang="en">
<div class="col-sm-12 mag-scorpio-news issue-12 page-11" style="border: 1px solid #000; padding-top: 1em; padding-bottom: 1em;" lang="en" id="page">
<!-- 1 column: start --><div>
<table>
<tr><td>D4&nbsp;=&nbsp;1&nbsp;&nbsp;&nbsp;&ndash;</td><td>In timer mode, positive edge starts timer.<br>
		In counter mode, positive edge decrements counter.</td></tr>
<tr><td>D4 = 0 &nbsp; &ndash;</td><td>In timer mode, negative edge starts timer.<br>
		In counter mode, negative edge decrements counter.<br><br></td></tr>
<tr><td>D3 = 1 &nbsp; &ndash;</td><td>is defined in timer mode only. Timer starts immediately (well, almost)</td></tr>
<tr><td>D3 = 0 &nbsp; &ndash;</td><td>defined in timer mode only. Timer starts after time constant has been
		loaded.<br><br></td></tr>
<tr><td>D2 = 1 &nbsp; &ndash;</td><td>Time constant word is next word to be written to this channel.</td></tr>
<tr><td>D2 = 0 &nbsp; &ndash;</td><td>No tine constant will follow (use the existing one)<br><br></td></tr>
<tr><td>D1 = 1 &nbsp; &ndash;</td><td>Reset channel. Channel stops counting or timing.</td></tr>
<tr><td>D1 = 0 &nbsp; &ndash;</td><td>Continue current operation.<br><br></td></tr>
<tr><td>D0 &nbsp; &nbsp; &nbsp; &nbsp; &ndash;</td><td>Always 1 for control byte.</td></tr>
</table>
<p>
To disable a <!-- External Link --><a href="https://www.zilog.com/docs/z80/ps0181.pdf" title="External Link: Z80 CTC" target="_blank" rel="noreferrer">CTC</a><!-- /External Link --> channel from causing an interrupt, the code is simple. Just
write a 01H to the appropriate channel. Like the other Z80 chips, it is
necessary to disable the system interrupts in case an interrupt occurs while the
disable instruction is being assimilated by the I/O chip. The code is only
slightly more complex than above:
</p>
<pre class="indent">
LD   A, 01h
DI             ; Disable CPU interrupts
OUT (CTCn),A   ; Disable CTC channel
EI             ; re-enable CPU interrupts
</pre>
<p>
A channel may not begin operations in any mode unless a valid time constant byte
has been written into the Time Constant Register. This byte is expected on the
next write to the channel in question following the write of the channel control
byte, provided the channel control byte had bit 2 set (= 1). If this time
constant byte is 0 it is interpreted as 256. If a new time constant byte
written to a channel already in operation, the new time constant byte is only
reloaded at the next count down to zero.
</p>
<p>
The major difference between Counter mode and Timer mode is that Counter mode
uses the external clock or pulse provided on the CLK/&#x200b;TRGn pin, whereas the Timer
mode uses the system clock, divided by the prescaler (either 16 or 256 according
to the setting of bit 5 of the channel control byte). In timer mode, the timing
operation can be programmed to start from an external trigger to the CLK/&#x200b;TRGn
pulse, or almost immediately from the system signals. The external starting
trigger is usually not required, and the reader is referred to the
manufacturer&rsquo;s data sheets for more precise details. It is also possible to
define whether the trigger or count decrement takes place on the rising or
falling edge of the timing clock (Bit 4). One constraint that is not very
openly defined is to be found in the technical details of the data sheet; this
states that the maximum frequency to be applied to the CLK/&#x200b;TRGn pin is to be
half of the system clock. This means that on a 4MHz system, the maximum
external clock to the CHC is to be 2&nbsp;MHz.
</p>
<p>
Now for a worked example. In the case of a standard
<!-- External Link --><a href="https://80bus.co.uk.mirror.jloh.de/pages/map80/MAP80_CPU.htm" title="External Link: MAP80 CPU" target="_blank" rel="noreferrer">MAP CPU</a><!-- /External Link -->, we wish to set up
the CTC as follows:
</p>
<table class="indent">
<tr><td>CTC0</td><td>is to drive SIO channel A to receive/&#x200b;transmit at 1200&nbsp;baud</td></tr>
<tr><td>CTC1</td><td>is to drive SIO channel B to receive/&#x200b;transmit at 300&nbsp;baud</td></tr>
<tr><td>CTC2</td><td>is not used</td></tr>
<tr><td>CTC3</td><td>is to receive the strobe from the keyboard, and to interrupt on each
		key</td></tr>
</table>
<p>
Rather than give a full listing of code, I will use the method set out in
<a href="../../14/text/#ref5">[5]</a>
for I/O port initialization, with comments beside the relevant bytes to explain
how they are arrived at. These initialization tables are set out like this:
</p>
<!-- 1 column: end --></div>

</div>
</div>
<!-- /The page -->
<!-- Navigation bottom -->
<table class="robots-nocontent style-table-zeropadding" style="width: 100%">
	<tr>
		<td class="navi-button">
			<a style="display: block" href="../../10/text/" title="Previous page"><span class="mirror-horizontal fas fa-play" aria-hidden=true></span></a>
		</td>
		<td class="navi-button">
			<a style="display: block" href="../../01/text/" title="First page"><span class="mirror-horizontal fas fa-fast-forward" aria-hidden=true></span></a>
		</td>
		<td class="navi-button">
			<a style="display: block" href="../../../11/01/text/" title="Previous issue"><span class="mirror-horizontal fas fa-forward" aria-hidden=true></span></a>
		</td>
		<th class="navi-button">
			<a style="display: block" href="../../text/" title="Table of Contents">Page 11 of 51</a>
		</th>
		<td class="navi-button">
			<a style="display: block" href="../../../13/01/text/" title="Next issue"><span class="fas fa-forward" aria-hidden=true></span></a>
		</td>
		<td class="navi-button">
			<a style="display: block" href="../../51/text/" title="Last page"><span class="fas fa-fast-forward" aria-hidden=true></span></a>
		</td>
		<td class="navi-button">
			<a style="display: block" href="../../12/text/" title="Next page"><span class="fas fa-play" aria-hidden=true></span></a>
		</td>
	</tr>
</table>

<!-- navi-footer.php / $Date: 2023-03-11 15:22:20 +0100 (Sa, 11. Mrz 2023) $ -->

<!--********************************************************************************-->

	</div>

	<nav class="nav flex-column flex-md-row style-navbar-bottom robots-nocontent"> <!--nav-pills-->
		<a class="sm-fill nav-link" href="#top"><span title="Nach oben" class="fa fa-chevron-up" aria-hidden=true></span></a>
		<a class="sm-fill nav-link" href="../">Graphic</a>
		<a class="sm-fill nav-link" href="https://80bus.co.uk.mirror.jloh.de/publications/magazines/Scorpio_News_1_2.pdf#page=11" target="_blank">PDF</a>
		<a class="sm-fill nav-link" href="../../../../../../datenschutzerklaerung/">Privacy Statement</a>
		<a class="sm-fill nav-link" href="../../../../../../impressum/">Imprint</a>
	</nav>

	<!--bootstrap-->
	<script src="../../../../../../cdn/bootstrap/js/bootstrap.bundle.min.js"></script>
</body>

<!-- /navi-footer.php -->
</html>

<!-- /page.php -->