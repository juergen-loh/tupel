<!doctype html>
<html lang="de">

<!-- navi-head.php / $Date: 2023-03-11 15:22:20 +0100 (Sa, 11. Mrz 2023) $ -->
<head>
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<meta charset="utf-8">

	<link rel="shortcut icon" type="image/x-icon" href="../../../../../../nascom/nascom.ico">
	<link rel="icon" type="image/png" href="../../../../../../nascom/apple-touch-icon.png" sizes="32x32">
	<link rel="icon" type="image/png" href="../../../../../../nascom/apple-touch-icon.png" sizes="96x96">
	<link rel="apple-touch-icon" sizes="180x180" href="../../../../../../nascom/apple-touch-icon.png">

	<!--bootstrap-->
	<link rel="stylesheet" href="../../../../../../cdn/bootstrap/css/bootstrap.min.css">

	<!--font awesome-->
	<link rel="stylesheet" href="../../../../../../cdn/fontawesome/css/fontawesome.min.css">
	<link rel="stylesheet" href="../../../../../../cdn/fontawesome/css/solid.min.css">

	<link rel="stylesheet" type="text/css" href="../../../../../../style.css">
<!-- /navi-head.php -->

	<!-- page.php / $Date: 2024-07-13 18:55:41 +0200 (Sa, 13. Jul 2024) $ -->

	<title>80-Bus News - Spring 1985 - Volume 4 - Issue 1</title>
	<!-- Wed, 01 Jan 2025 19:19:14 GMT -->
	<meta name="keywords" content="80-Bus News, Nascom Computer, Nascom 1, Nascom 2">
	<link rel="stylesheet" type="text/css" href="../../../style.css">
<!-- navi-body.php -->
</head>

<body>
	<nav class="navbar navbar-expand-md navbar-light bg-light style-navbar-top" id="top">
	<div class="container-fluid">
		<a class="navbar-brand" href="https://jloh.de/">
			<img src="../../../../../../favicon.ico" width="32" height="32" alt="JL" title="Homepage von JÃ¼rgen Loh">
		</a>
		<button
			class="navbar-toggler"
			type="button"
			data-bs-toggle="collapse"
			data-bs-target="#navbarSupportedContent"
			aria-controls="navbarSupportedContent"
			aria-expanded="false"
			aria-label="Toggle navigation"
		>
			<span class="navbar-toggler-icon"></span>
		</button>
		<div class="collapse navbar-collapse robots-nocontent" id="navbarSupportedContent">
			<ul class="navbar-nav md-auto">
				<li class="nav-item">
					<a class="nav-link" href="../../../../../../z80-kit/">Z80-KIT</a>
				</li>
				<li class="nav-item">
					<a class="nav-link" href="../../../../../../nascom/1/">Nascom 1</a>
				</li>
				<li class="nav-item">
					<a class="nav-link" href="../../../../../../nascom/">Nascom Journal</a>
				</li>
				<li class="nav-item">
					<a class="nav-link active" href="../../../../../../nascom/magazines/issues/">Nascom Magazines</a>
				</li>
				<li class="nav-item">
					<a class="nav-link" href="../../../../../../pico/">PICO</a>
				</li>
				<li class="nav-item">
					<a class="nav-link" href="../../../../../../cpm-plus/">CP/M</a>
				</li>
				<li class="nav-item">
					<a class="nav-link" href="../../../../../../">Tupel BBS</a>
				</li>
			</ul>
		</div>
	</div>
	</nav>

	<div class="container" style="max-width: 750px; color: #000; padding: 0 15px 0; background-color: #FFF">

<!--********************************************************************************-->

<!-- /navi-body.php / $Date: 2024-12-30 14:10:13 +0100 (Mo, 30. Dez 2024) $ -->
<table class="style-table-zeropadding" style="width: 100%">
<tr>
<td>
<h1 class="h1Navi">80-Bus News</h1>
</td>
<td>&nbsp;&nbsp;</td>
<td style="vertical-align:top">
<h2 class="h2Navi">Spring 1985 &middot; <span class="nowrap">Volume 4 &middot;</span> <span class="nowrap">Issue 1</span></h2>
</td>
</tr>
</table>
<!-- Navigation top -->
<table class="robots-nocontent style-table-zeropadding" style="width: 100%">
	<tr>
		<td class="navi-button">
			<a style="display: block" href="../../09/text/" title="Previous page"><span class="mirror-horizontal fas fa-play" aria-hidden=true></span></a>
		</td>
		<td class="navi-button">
			<a style="display: block" href="../../01/text/" title="First page"><span class="mirror-horizontal fas fa-fast-forward" aria-hidden=true></span></a>
		</td>
		<td class="navi-button">
			<a style="display: block" href="../../../36/01/text/" title="Previous issue"><span class="mirror-horizontal fas fa-forward" aria-hidden=true></span></a>
		</td>
		<th class="navi-button">
			<a style="display: block" href="../../text/" title="Table of Contents">Page 10 of 31</a>
		</th>
		<td class="navi-button">
			<a style="display: block" href="../../../42/01/text/" title="Next issue"><span class="fas fa-forward" aria-hidden=true></span></a>
		</td>
		<td class="navi-button">
			<a style="display: block" href="../../31/text/" title="Last page"><span class="fas fa-fast-forward" aria-hidden=true></span></a>
		</td>
		<td class="navi-button">
			<a style="display: block" href="../../11/text/" title="Next page"><span class="fas fa-play" aria-hidden=true></span></a>
		</td>
	</tr>
</table>
<!-- The page -->
<div class="row" lang="en">
<div class="col-sm-12 mag-80-bus-news issue-41 page-10" style="border: 1px solid #000; padding-top: 1em; padding-bottom: 1em;" lang="en" id="page">
<!-- 2(2) columns: start --><div><div class="style-multi-column-2 hyphenate 2">
<p>
rotate, until some time later, the correct track/&#x200b;sector
header will pass the head. At this instant, the
controller looks for the data start mark, and when
that&rsquo;s found it then reads the following data.
</p>
<p>
Having got the data, control is passed back to CP/M
which now has to calculate the next track/&#x200b;sector
required. CP/M decides that the track/&#x200b;sector will be
4/2, the next sector. An instruction is issued to the
controller, and the previous process is repeated,
except that the controller now knows that it is on
track 4 (the last sector was on track 4, and nothing
has changed, so the head must still be on track 4).
Unfortunately, whilst all this was going on, the disk
of course continued to rotate, so by the time the
system has made up its mind that it is sector 2 it is
looking for, the header for sector 2 has just passed
the head. This means that the disk must make a full
rotation before sector 2 again passes the head. As
the disk rotates at 300 rpm, that means that 200mS
must elapse before the next sector can be read.
Considering that a typical <i>Gemini</i> system reads a
512 byte sector in 20mS, this hanging about is a
real pain. It would take ten times as long to load a
program under these circumstances as it would if
we arrange the sectors to be in the correct places
when CP/M wanted them.
</p>
<p>
So we introduce &lsquo;skew&rsquo; in to the format program,
we alter the way the sectors are numbered on the
disk, on a <i>Gemini</i> system, a &lsquo;straight&rsquo; skew of:
</p>
<table style="width: 100%">
<tr><td>Sector number</td><td>1</td><td>2</td><td>3</td><td>4</td><td>5</td><td>6</td><td>7</td><td>8</td><td>9</td><td>10</td></tr>
<tr><td></td><td colspan=10 class="center">becomes something like</td></tr>
<tr><td>Sector number</td><td>1</td><td>6</td><td>2</td><td>7</td><td>3</td><td>8</td><td>4</td><td>9</td><td>5</td><td>10</td></tr>
</table>
<p>
I say something like this, as I haven&rsquo;t bothered to
look at the actual <i>Gemini</i> skew, so I might have it
slightly out, but no matter. This is a &lsquo;skew&rsquo; of 2, that
is the sectors appear in order in 2&rsquo;s, read one, skip
one, and so on. See what happens, having read
sector 1, and then requiring sector 2, the longest
wait would be 20mS whilst sector 6 went past.
Plenty of time to calculate the next track/&#x200b;sector as
being sector 2.
</p>
<p>
Lets suppose that some program we have written
is required to read the disk and actually does some
preprocessing between sector reads, or that the
system clock is running at 2MHz rather than 4MHz.
Then things slow up again as even with a skew of
2, the 20mS between consecutively numbered
sectors is not long enough. In that case, to restore
the speed to something like normal, a skew of 3
may be required.
</p>
<p>
So by now the business of skewing the disk has
been taken care off, the only remaining question is
if this problem has been known for a long time,
why didn&rsquo;t Digital Research do something to CP/M
to correct the situation instead of skewing the disks
on formatting? The answer is that they did, right
from the start. This is called &lsquo;logical to physical
sector translation&rsquo;. Inside CP/M is the sector
translation table. It assumes that the disk is
formatted in 1, 2, 3, &hellip; order, and therefore the
CP/M calculation to get a certain logical sector
must be translated into the appropriate physical
sector.
</p>
<p>
Lets take the case of a skew of 2 illustrated above.
CP/M calculates it wants logical sector 1, so it goes
to the &lsquo;logical &ndash; physical sector translation&rsquo; table
and looks up logical sector 1 which comes back as
physical sector 1. For the next sector, it calculates
logical sector 2 which is translated into physical
sector 3, logical sector 3 becomes physical sector 5,
and so on. There are a couple of good reasons for
not using the &lsquo;logical to physical sector translation&rsquo;
one is that you can&rsquo;t alter it easily. But worse, if the
disk were transported to another machine with a
different &lsquo;translation&rsquo; the sectors would be read in
the wrong order, so data would become garbage
and programs would crash. The advantages of
using physical disk skewing is that you have
control of it and even if a disk were transported to
a different machine and the skew were wrong, then
the disk would read slowly, but it would get there
eventually and get it right.
</p>
<p>
The very early
<i><!-- External Link --><a href="https://80bus.co.uk.mirror.jloh.de/pages/gemini/gm805.htm" title="External Link" target="_blank" rel="noreferrer">Henelec</a><!-- /External Link -->/&#x200b;Gemini</i>
<!-- External Link --><a href="https://80bus.co.uk.mirror.jloh.de/pages/gemini/gm805.htm" title="External Link" target="_blank" rel="noreferrer">GM805</a><!-- /External Link -->
had a
&lsquo;logical to physical translation&rsquo; of 6 which was
originally intended for 8&Prime; disk systems. (I think it
was built in permanently to CP/M&nbsp;1.4, so couldn&rsquo;t
be changed to something more appropriate.) This
made the
<!-- External Link --><a href="https://80bus.co.uk.mirror.jloh.de/pages/gemini/gm805.htm" title="External Link" target="_blank" rel="noreferrer">GM805</a><!-- /External Link -->
system slow, and I remember
sitting down one evening with Eddie Pounce and
playing with strips of cardboard numbered in
sectors and sliding one against the other until an
optimum skew was arrived at. As I remember, it
ended up as a negative number, as we already had
a positive skew of 6, we needed to skew the disk
backwards to improve matters. The skew tables for
2 and 4MHz were then added into the format
routine written by Richard Cowdroy supplied with
the system to become Version 2.0 of the formatter.
All great fun when you have both physical skewing
and &lsquo;logical to physical sector translation&rsquo;.
</p>
<h4>
Back to the problem
</h4>
<p>
So, back to the beginning, how come my stupid
copy routine took so long to write out its files to
disk. Simple, the timing was all to pot. But not by
the obvious skewing problem of the routine taking
too much time between sectors. It was in fact a
whole different can of worms called &lsquo;sector
deblocking&rsquo;, something I&rsquo;ll hold over until another
time, but brief explanation is required.
</p>
<p>
CP/M was originally designed for use with 8&Prime;
systems conforming to IBM3740 spec. The disks
had physical 128 byte sectors, so it was sensible to
make CP/M work internally with 128 byte sectors.
</p>
<!-- 2 columns: end --></div></div>

</div>
</div>
<!-- /The page -->
<!-- Navigation bottom -->
<table class="robots-nocontent style-table-zeropadding" style="width: 100%">
	<tr>
		<td class="navi-button">
			<a style="display: block" href="../../09/text/" title="Previous page"><span class="mirror-horizontal fas fa-play" aria-hidden=true></span></a>
		</td>
		<td class="navi-button">
			<a style="display: block" href="../../01/text/" title="First page"><span class="mirror-horizontal fas fa-fast-forward" aria-hidden=true></span></a>
		</td>
		<td class="navi-button">
			<a style="display: block" href="../../../36/01/text/" title="Previous issue"><span class="mirror-horizontal fas fa-forward" aria-hidden=true></span></a>
		</td>
		<th class="navi-button">
			<a style="display: block" href="../../text/" title="Table of Contents">Page 10 of 31</a>
		</th>
		<td class="navi-button">
			<a style="display: block" href="../../../42/01/text/" title="Next issue"><span class="fas fa-forward" aria-hidden=true></span></a>
		</td>
		<td class="navi-button">
			<a style="display: block" href="../../31/text/" title="Last page"><span class="fas fa-fast-forward" aria-hidden=true></span></a>
		</td>
		<td class="navi-button">
			<a style="display: block" href="../../11/text/" title="Next page"><span class="fas fa-play" aria-hidden=true></span></a>
		</td>
	</tr>
</table>

<!-- navi-footer.php / $Date: 2023-03-11 15:22:20 +0100 (Sa, 11. Mrz 2023) $ -->

<!--********************************************************************************-->

	</div>

	<nav class="nav flex-column flex-md-row style-navbar-bottom robots-nocontent"> <!--nav-pills-->
		<a class="sm-fill nav-link" href="#top"><span title="Nach oben" class="fa fa-chevron-up" aria-hidden=true></span></a>
		<a class="sm-fill nav-link" href="../">Graphic</a>
		<a class="sm-fill nav-link" href="https://80bus.co.uk.mirror.jloh.de/publications/magazines/80bus_news_41.pdf#page=10" target="_blank">PDF</a>
		<a class="sm-fill nav-link" href="../../../../../../datenschutzerklaerung/">Privacy Statement</a>
		<a class="sm-fill nav-link" href="../../../../../../impressum/">Imprint</a>
	</nav>

	<!--bootstrap-->
	<script src="../../../../../../cdn/bootstrap/js/bootstrap.bundle.min.js"></script>
</body>

<!-- /navi-footer.php -->
</html>

<!-- /page.php -->