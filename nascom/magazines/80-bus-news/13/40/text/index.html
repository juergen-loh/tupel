<!doctype html>
<html lang="de">

<!-- navi-head.php / $Date: 2023-03-11 15:22:20 +0100 (Sa, 11. Mrz 2023) $ -->
<head>
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<meta charset="utf-8">

	<link rel="shortcut icon" type="image/x-icon" href="../../../../../../nascom/nascom.ico">
	<link rel="icon" type="image/png" href="../../../../../../nascom/apple-touch-icon.png" sizes="32x32">
	<link rel="icon" type="image/png" href="../../../../../../nascom/apple-touch-icon.png" sizes="96x96">
	<link rel="apple-touch-icon" sizes="180x180" href="../../../../../../nascom/apple-touch-icon.png">

	<!--bootstrap-->
	<link rel="stylesheet" href="../../../../../../cdn/bootstrap/css/bootstrap.min.css">

	<!--font awesome-->
	<link rel="stylesheet" href="../../../../../../cdn/fontawesome/css/fontawesome.min.css">
	<link rel="stylesheet" href="../../../../../../cdn/fontawesome/css/solid.min.css">

	<link rel="stylesheet" type="text/css" href="../../../../../../style.css">
<!-- /navi-head.php -->

	<!-- page.php / $Date: 2024-06-16 15:50:29 +0200 (So, 16. Jun 2024) $ -->

	<title>80-Bus News - July&ndash;October 1982 - Volume 1 - Issue 3</title>
	<!-- Sun, 30 Jun 2024 10:05:41 GMT -->
	<meta name="keywords" content="80-Bus News, Nascom Computer, Nascom 1, Nascom 2">
	<link rel="stylesheet" type="text/css" href="../../../style.css">
<!-- navi-body.php -->
</head>

<body>
	<nav class="navbar navbar-expand-md navbar-light bg-light style-navbar-top" id="top">
	<div class="container-fluid">
		<a class="navbar-brand" href="https://jloh.de/">
			<img src="../../../../../../favicon.ico" width="32" height="32" alt="JL" title="Homepage von JÃ¼rgen Loh">
		</a>
		<button
			class="navbar-toggler"
			type="button"
			data-bs-toggle="collapse"
			data-bs-target="#navbarSupportedContent"
			aria-controls="navbarSupportedContent"
			aria-expanded="false"
			aria-label="Toggle navigation"
		>
			<span class="navbar-toggler-icon"></span>
		</button>
		<div class="collapse navbar-collapse robots-nocontent" id="navbarSupportedContent">
			<ul class="navbar-nav md-auto">
				<li class="nav-item">
					<a class="nav-link" href="../../../../../../z80-kit/">Z80-KIT</a>
				</li>
				<li class="nav-item">
					<a class="nav-link" href="../../../../../../nascom/1/">Nascom 1</a>
				</li>
				<li class="nav-item">
					<a class="nav-link" href="../../../../../../nascom/">Nascom Journal</a>
				</li>
				<li class="nav-item">
					<a class="nav-link active" href="../../../../../../nascom/magazines/issues/">Nascom Magazines</a>
				</li>
				<li class="nav-item">
					<a class="nav-link" href="../../../../../../pico/">PICO</a>
				</li>
				<li class="nav-item">
					<a class="nav-link" href="../../../../../../cpm-plus/">CP/M</a>
				</li>
				<li class="nav-item">
					<a class="nav-link" href="../../../../../../">Tupel BBS</a>
				</li>
			</ul>
		</div>
	</div>
	</nav>

	<div class="container" style="max-width: 750px; color: #000; padding: 0 15px 0; background-color: #FFF">

<!--********************************************************************************-->

<!-- /navi-body.php / $Date: 2024-06-30 12:05:40 +0200 (So, 30. Jun 2024) $ -->
<table class="style-table-zeropadding" style="width: 100%">
<tr>
<td>
<h1 class="h1Navi">80-Bus News</h1>
</td>
<td>&nbsp;&nbsp;</td>
<td style="vertical-align:top">
<h2 class="h2Navi">July&ndash;October 1982 &middot; <span class="nowrap">Volume 1 &middot;</span> <span class="nowrap">Issue 3</span></h2>
</td>
</tr>
</table>
<!-- Navigation top -->
<table class="robots-nocontent style-table-zeropadding" style="width: 100%">
	<tr>
		<td class="navi-button">
			<a style="display: block" href="../../39/text/" title="Previous page"><span class="mirror-horizontal fas fa-play" aria-hidden=true></span></a>
		</td>
		<td class="navi-button">
			<a style="display: block" href="../../01/text/" title="First page"><span class="fas fa-fast-backward" aria-hidden=true></span></a>
		</td>
		<td class="navi-button">
			<a style="display: block" href="../../../12/01/text/" title="Previous issue"><span class="fas fa-backward" aria-hidden=true></span></a>
		</td>
		<th class="navi-button">
			<a style="display: block" href="../../text/" title="Table of Contents">Page 40 of 51</a>
		</th>
		<td class="navi-button">
			<a style="display: block" href="../../../14/01/text/" title="Next issue"><span class="fas fa-forward" aria-hidden=true></span></a>
		</td>
		<td class="navi-button">
			<a style="display: block" href="../../51/text/" title="Last page"><span class="fas fa-fast-forward" aria-hidden=true></span></a>
		</td>
		<td class="navi-button">
			<a style="display: block" href="../../41/text/" title="Next page"><span class="fas fa-play" aria-hidden=true></span></a>
		</td>
	</tr>
</table>
<!-- The page -->
<div class="row" lang="en">
<div class="col-sm-12 mag-80-bus-news issue-13 page-40" style="border: 1px solid #000; padding-top: 1em; padding-bottom: 1em;" lang="en" id="page">
<!-- 3 columns: start 2 --><div class="row"><div class="col-sm-8">
<h2 id="article1">
<u class="double">GM809 and Eight Inch Drives</u>
</h2>
<!-- 3 columns: change --></div><div class="col-sm-4">
<h3 class="author">
by D. Parkinson
</h3>
<!-- 3 columns: end --></div></div>
<!-- 1 column: start --><div class="noindent">
<p>
Every once in a while I get an enquiry (or statement!) passed to me about the
possiblity (or impossibility!) of using the Gemini
<!-- External Link --><a href="https://80bus.co.uk.mirror.jloh.de/pages/gemini/gm809.htm" title="External Link" target="_blank" rel="noreferrer">GM809</a><!-- /External Link -->
disk controller card (for
which I have written various BIOS&rsquo;s) with double density 8&Prime; drives. Rather than
publish a few lines of code showing how it can be done I&rsquo;ve presented it in the
form of a short tutorial in the hope that people other than those with 8&Prime; drives and
GM809 will find it useful.
</p>
<p>
Problem: How to code a routine to handle the data transfer for the Western Digital
1797 disk controller and 8&Prime; double density drives? (In the following discussion it
is assumed that the target system has a Z80A running at 4MHz with no Wait states.
However the same arguments apply to a 2MHz system and double density 5.25&Prime; drives,
but all the times should be doubled).
</p>
<p class="indent2" style="text-indent: -6em">
It will be useful, though not essential, if the following items are to hand:<br>
GM809 circuit diagram.<br>
1797 Data sheet.<br>
Z80 Data sheet.
</p>
<p>
An 8&Prime; DD disk has a serial data transfer rate of 250kbits/sec which results in a
byte transfer to/from the controller every 16us (64 T-states with a 4MHz clock).
Therefore it would appear that the data transfer routine must be able to move data
at this rate. Can this be achieved?
</p>
<p>
Once the 1797 controller has been given a Read or Write instruction the controlling
program then has to transfer the data to/from the disk under the control of the DRQ
(Data ReQuest) signal from the 1797. This DRQ signal appears externally (on pin 38)
of the 1797, and also internally as bit 1 of the status byte that can be read from
the 1797. When the data transfer is complete (or the 1797 gives up because of an
error condition), the INTRQ signal, (INTerrupt ReQuest), on pin 39 comes on. (Also
bit 0, the &ldquo;Busy&rdquo; flag, gets reset in the internal status register). With GM809
the external DRQ and INTRQ signals are connected to bits 7 and 0 of another input port,
and so may be read directly as well as via the bits in the 1797&rsquo;s internal status
register.
</p>
<p>
Shown below is a first attempt at coding the data transfer routine for the Read
command. All it has to do is transfer a byte every time a DRQ (Data ReQuest)
occurs, and exit when an IRQ (Interrupt ReQuest) occurs. Note that it uses the
externally read status bits.
</p>
<img class="img-fluid" src="../../Image-40-1.png" alt="" width="540" height="224">
<p>
The AND 81H masks out the DRQ and INTRQ status bits. If neither is set the Z flag
gets set and so the routine waits. Once one or other bit is set it will fall
through to the following bit of code. At this point there is no need to do a
</p>
<!-- 1 column: end --></div>

</div>
</div>
<!-- /The page -->
<!-- Navigation bottom -->
<table class="robots-nocontent style-table-zeropadding" style="width: 100%">
	<tr>
		<td class="navi-button">
			<a style="display: block" href="../../39/text/" title="Previous page"><span class="mirror-horizontal fas fa-play" aria-hidden=true></span></a>
		</td>
		<td class="navi-button">
			<a style="display: block" href="../../01/text/" title="First page"><span class="fas fa-fast-backward" aria-hidden=true></span></a>
		</td>
		<td class="navi-button">
			<a style="display: block" href="../../../12/01/text/" title="Previous issue"><span class="fas fa-backward" aria-hidden=true></span></a>
		</td>
		<th class="navi-button">
			<a style="display: block" href="../../text/" title="Table of Contents">Page 40 of 51</a>
		</th>
		<td class="navi-button">
			<a style="display: block" href="../../../14/01/text/" title="Next issue"><span class="fas fa-forward" aria-hidden=true></span></a>
		</td>
		<td class="navi-button">
			<a style="display: block" href="../../51/text/" title="Last page"><span class="fas fa-fast-forward" aria-hidden=true></span></a>
		</td>
		<td class="navi-button">
			<a style="display: block" href="../../41/text/" title="Next page"><span class="fas fa-play" aria-hidden=true></span></a>
		</td>
	</tr>
</table>

<!-- navi-footer.php / $Date: 2023-03-11 15:22:20 +0100 (Sa, 11. Mrz 2023) $ -->

<!--********************************************************************************-->

	</div>

	<nav class="nav flex-column flex-md-row style-navbar-bottom robots-nocontent"> <!--nav-pills-->
		<a class="sm-fill nav-link" href="#top"><span title="Nach oben" class="fa fa-chevron-up" aria-hidden=true></span></a>
		<a class="sm-fill nav-link" href="../">Graphic</a>
		<a class="sm-fill nav-link" href="https://80bus.co.uk.mirror.jloh.de/publications/magazines/80bus_news_13.pdf#page=40" target="_blank">PDF</a>
		<a class="sm-fill nav-link" href="../../../../../../datenschutzerklaerung/">Privacy Statement</a>
		<a class="sm-fill nav-link" href="../../../../../../impressum/">Imprint</a>
	</nav>

	<!--bootstrap-->
	<script src="../../../../../../cdn/bootstrap/js/bootstrap.bundle.min.js"></script>
</body>

<!-- /navi-footer.php -->
</html>

<!-- /page.php -->