<!doctype html>
<html lang="de">

<!-- navi-head.php / $Date: 2023-03-11 15:22:20 +0100 (Sa, 11. Mrz 2023) $ -->
<head>
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<meta charset="utf-8">

	<link rel="shortcut icon" type="image/x-icon" href="../../../../../../nascom/nascom.ico">
	<link rel="icon" type="image/png" href="../../../../../../nascom/apple-touch-icon.png" sizes="32x32">
	<link rel="icon" type="image/png" href="../../../../../../nascom/apple-touch-icon.png" sizes="96x96">
	<link rel="apple-touch-icon" sizes="180x180" href="../../../../../../nascom/apple-touch-icon.png">

	<!--bootstrap-->
	<link rel="stylesheet" href="../../../../../../cdn/bootstrap/css/bootstrap.min.css">

	<!--font awesome-->
	<link rel="stylesheet" href="../../../../../../cdn/fontawesome/css/fontawesome.min.css">
	<link rel="stylesheet" href="../../../../../../cdn/fontawesome/css/solid.min.css">

	<link rel="stylesheet" type="text/css" href="../../../../../../style.css">
<!-- /navi-head.php -->

	<!-- page.php / $Date: 2024-07-13 18:55:41 +0200 (Sa, 13. Jul 2024) $ -->

	<title>80-Bus News - July&ndash;October 1982 - Volume 1 - Issue 3</title>
	<!-- Sun, 15 Dec 2024 13:34:13 GMT -->
	<meta name="keywords" content="80-Bus News, Nascom Computer, Nascom 1, Nascom 2">
	<link rel="stylesheet" type="text/css" href="../../../style.css">
<!-- navi-body.php -->
</head>

<body>
	<nav class="navbar navbar-expand-md navbar-light bg-light style-navbar-top" id="top">
	<div class="container-fluid">
		<a class="navbar-brand" href="https://jloh.de/">
			<img src="../../../../../../favicon.ico" width="32" height="32" alt="JL" title="Homepage von JÃ¼rgen Loh">
		</a>
		<button
			class="navbar-toggler"
			type="button"
			data-bs-toggle="collapse"
			data-bs-target="#navbarSupportedContent"
			aria-controls="navbarSupportedContent"
			aria-expanded="false"
			aria-label="Toggle navigation"
		>
			<span class="navbar-toggler-icon"></span>
		</button>
		<div class="collapse navbar-collapse robots-nocontent" id="navbarSupportedContent">
			<ul class="navbar-nav md-auto">
				<li class="nav-item">
					<a class="nav-link" href="../../../../../../z80-kit/">Z80-KIT</a>
				</li>
				<li class="nav-item">
					<a class="nav-link" href="../../../../../../nascom/1/">Nascom 1</a>
				</li>
				<li class="nav-item">
					<a class="nav-link" href="../../../../../../nascom/">Nascom Journal</a>
				</li>
				<li class="nav-item">
					<a class="nav-link active" href="../../../../../../nascom/magazines/issues/">Nascom Magazines</a>
				</li>
				<li class="nav-item">
					<a class="nav-link" href="../../../../../../pico/">PICO</a>
				</li>
				<li class="nav-item">
					<a class="nav-link" href="../../../../../../cpm-plus/">CP/M</a>
				</li>
				<li class="nav-item">
					<a class="nav-link" href="../../../../../../">Tupel BBS</a>
				</li>
			</ul>
		</div>
	</div>
	</nav>

	<div class="container" style="max-width: 750px; color: #000; padding: 0 15px 0; background-color: #FFF">

<!--********************************************************************************-->

<!-- /navi-body.php / $Date: 2024-12-15 14:31:39 +0100 (So, 15. Dez 2024) $ -->
<table class="style-table-zeropadding" style="width: 100%">
<tr>
<td>
<h1 class="h1Navi">80-Bus News</h1>
</td>
<td>&nbsp;&nbsp;</td>
<td style="vertical-align:top">
<h2 class="h2Navi">July&ndash;October 1982 &middot; <span class="nowrap">Volume 1 &middot;</span> <span class="nowrap">Issue 3</span></h2>
</td>
</tr>
</table>
<!-- Navigation top -->
<table class="robots-nocontent style-table-zeropadding" style="width: 100%">
	<tr>
		<td class="navi-button">
			<a style="display: block" href="../../41/text/" title="Previous page"><span class="mirror-horizontal fas fa-play" aria-hidden=true></span></a>
		</td>
		<td class="navi-button">
			<a style="display: block" href="../../01/text/" title="First page"><span class="mirror-horizontal fas fa-fast-forward" aria-hidden=true></span></a>
		</td>
		<td class="navi-button">
			<a style="display: block" href="../../../12/01/text/" title="Previous issue"><span class="mirror-horizontal fas fa-forward" aria-hidden=true></span></a>
		</td>
		<th class="navi-button">
			<a style="display: block" href="../../text/" title="Table of Contents">Page 42 of 51</a>
		</th>
		<td class="navi-button">
			<a style="display: block" href="../../../14/01/text/" title="Next issue"><span class="fas fa-forward" aria-hidden=true></span></a>
		</td>
		<td class="navi-button">
			<a style="display: block" href="../../51/text/" title="Last page"><span class="fas fa-fast-forward" aria-hidden=true></span></a>
		</td>
		<td class="navi-button">
			<a style="display: block" href="../../43/text/" title="Next page"><span class="fas fa-play" aria-hidden=true></span></a>
		</td>
	</tr>
</table>
<!-- The page -->
<div class="row" lang="en">
<div class="col-sm-12 mag-80-bus-news issue-13 page-42" style="border: 1px solid #000; padding-top: 1em; padding-bottom: 1em;" lang="en" id="page">
<!-- 1 column: start --><div class="noindent">
<p>
The relevant parts of the 1797 data sheet are the boxes READ ENABLE TIMING on page
19, and WRITE ENABLE TIMING on page&nbsp;20. Each contains a footnote in minute print in
the bottom left-hand corner&nbsp;&ndash; there is a &ldquo;worst case service time&rdquo;. The data may be
coming at the nominal rate of one byte every 16us, but when reading, the byte must
be read within 13.5us (54 T states) of the DRQ signal appearing, and when writing,
the next byte must be supplied within 11.5us (46 T states) of the DRQ request&nbsp;&ndash;
which is even worse! The code developed above does not meet these figures, so how
can it be compressed further?
</p>
<p>
Fortunately there is a way out of this dilema. It utilises one of the facets of the
unique Z80 instructions, and is catered for in the hardware of
<!-- External Link --><a href="https://80bus.co.uk.mirror.jloh.de/pages/gemini/gm809.htm" title="External Link" target="_blank" rel="noreferrer">GM809</a><!-- /External Link -->
.
You may have
wondered why the additional Status port is provided (at E4h) through which the DRQ
and IRQ bits can be checked, when the same bits can be accessed through the
internal status register of the 1797. Looking further at the circuit diagram will
reveal that, as well as DRQ and IRQ being connected to the external input port,
there is a connection to the &ldquo;Motor on&rdquo; monostable, (which should present a &lsquo;0&rsquo;
during normal disk I/O), and that the remaining lines are connected to 0V. Turning
to the I/O instructions in the Z80 data sheets it can be seen that while the <!-- External Link --><a href="https://en.wikipedia.org/wiki/Intel_8080" title="External Link" target="_blank" rel="noreferrer">8080</a><!-- /External Link -->
compatible IN A,(n) does not affect any of the bits in the flag register, the extra
Z80 instructions&nbsp;&ndash; IN r,(C) where the port address is held in register C&nbsp;&ndash; does set
the flags as a result of this operation. So if one of these instructions is used,
the &ldquo;Input and Test&rdquo; operation can be completed in one go, and a very tight polling
loop will result. However note that this can only be done if the &ldquo;Wait&rdquo; condition
sets the flags suitably&nbsp;&ndash; this is why it is necessary to use a special port for the
DRQ and IRQ inputs, as the internal Status register of the 1797 contains a variety
of other bits which would prevent this happening. Adding the &ldquo;Motor on&rdquo; signal to
the same port ensures that, if for some reason neither IRQ or DRQ occur, then the
loop will be broken when the &ldquo;Motor on&rdquo; monostable finally times out.
</p>
<p>
The revised code for Read and Write now looks like this:
</p>
<img class="img-fluid" src="../../Image-42-1.png" alt="" width="534" height="369">
<p>
Note that in the WRITE section a byte is pre-fetched and output immediately in
response to the Status byte being non-zero. This ensures that the worst case
service time of 11.5us is met, and the final (and extra) byte output this way (on
the IRQ) will be ignored by the 1797 and so does not matter. However if it is
intended to use the value of HL on return from the Write routine for any reason
this point should be remembered.
</p>
<!-- 1 column: end --></div>

</div>
</div>
<!-- /The page -->
<!-- Navigation bottom -->
<table class="robots-nocontent style-table-zeropadding" style="width: 100%">
	<tr>
		<td class="navi-button">
			<a style="display: block" href="../../41/text/" title="Previous page"><span class="mirror-horizontal fas fa-play" aria-hidden=true></span></a>
		</td>
		<td class="navi-button">
			<a style="display: block" href="../../01/text/" title="First page"><span class="mirror-horizontal fas fa-fast-forward" aria-hidden=true></span></a>
		</td>
		<td class="navi-button">
			<a style="display: block" href="../../../12/01/text/" title="Previous issue"><span class="mirror-horizontal fas fa-forward" aria-hidden=true></span></a>
		</td>
		<th class="navi-button">
			<a style="display: block" href="../../text/" title="Table of Contents">Page 42 of 51</a>
		</th>
		<td class="navi-button">
			<a style="display: block" href="../../../14/01/text/" title="Next issue"><span class="fas fa-forward" aria-hidden=true></span></a>
		</td>
		<td class="navi-button">
			<a style="display: block" href="../../51/text/" title="Last page"><span class="fas fa-fast-forward" aria-hidden=true></span></a>
		</td>
		<td class="navi-button">
			<a style="display: block" href="../../43/text/" title="Next page"><span class="fas fa-play" aria-hidden=true></span></a>
		</td>
	</tr>
</table>

<!-- navi-footer.php / $Date: 2023-03-11 15:22:20 +0100 (Sa, 11. Mrz 2023) $ -->

<!--********************************************************************************-->

	</div>

	<nav class="nav flex-column flex-md-row style-navbar-bottom robots-nocontent"> <!--nav-pills-->
		<a class="sm-fill nav-link" href="#top"><span title="Nach oben" class="fa fa-chevron-up" aria-hidden=true></span></a>
		<a class="sm-fill nav-link" href="../">Graphic</a>
		<a class="sm-fill nav-link" href="https://80bus.co.uk.mirror.jloh.de/publications/magazines/80bus_news_13.pdf#page=42" target="_blank">PDF</a>
		<a class="sm-fill nav-link" href="../../../../../../datenschutzerklaerung/">Privacy Statement</a>
		<a class="sm-fill nav-link" href="../../../../../../impressum/">Imprint</a>
	</nav>

	<!--bootstrap-->
	<script src="../../../../../../cdn/bootstrap/js/bootstrap.bundle.min.js"></script>
</body>

<!-- /navi-footer.php -->
</html>

<!-- /page.php -->