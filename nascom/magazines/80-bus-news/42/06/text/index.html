<!doctype html>
<html lang="de">

<!-- navi-head.php / $Date: 2025-01-05 17:13:18 +0100 (So, 05. Jan 2025) $ -->
<head>
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<meta charset="utf-8">

	<link rel="shortcut icon" type="image/x-icon" href="../../../../../../nascom/nascom.ico">
	<link rel="icon" type="image/png" href="../../../../../../nascom/apple-touch-icon.png" sizes="32x32">
	<link rel="icon" type="image/png" href="../../../../../../nascom/apple-touch-icon.png" sizes="96x96">
	<link rel="apple-touch-icon" sizes="180x180" href="../../../../../../nascom/apple-touch-icon.png">

	<!--bootstrap-->
	<link rel="stylesheet" href="../../../../../../cdn/bootstrap/css/bootstrap.min.css">

	<!--font awesome-->
	<link rel="stylesheet" href="../../../../../../cdn/fontawesome/css/fontawesome.min.css">
	<link rel="stylesheet" href="../../../../../../cdn/fontawesome/css/solid.min.css">

	<link rel="stylesheet" type="text/css" href="../../../../../../style.css">
	<link rel="canonical" href="https://tupel.jloh.de/nascom/magazines/80-bus-news/42/06/text/">
<!-- /navi-head.php -->

	<!-- page.php / $Date: 2024-07-13 18:55:41 +0200 (Sa, 13. Jul 2024) $ -->

	<title>80-Bus News - Summer 1985 - Volume 4 - Issue 2</title>
	<!-- Sun, 05 Jan 2025 16:13:18 GMT -->
	<meta name="keywords" content="80-Bus News, Nascom Computer, Nascom 1, Nascom 2">
	<link rel="stylesheet" type="text/css" href="../../../style.css">
<!-- navi-body.php -->
</head>

<body>
	<nav class="navbar navbar-expand-md navbar-light bg-light style-navbar-top" id="top">
	<div class="container-fluid">
		<a class="navbar-brand" href="https://jloh.de/">
			<img src="../../../../../../favicon.ico" width="32" height="32" alt="JL" title="Homepage von JÃ¼rgen Loh">
		</a>
		<button
			class="navbar-toggler"
			type="button"
			data-bs-toggle="collapse"
			data-bs-target="#navbarSupportedContent"
			aria-controls="navbarSupportedContent"
			aria-expanded="false"
			aria-label="Toggle navigation"
		>
			<span class="navbar-toggler-icon"></span>
		</button>
		<div class="collapse navbar-collapse robots-nocontent" id="navbarSupportedContent">
			<ul class="navbar-nav md-auto">
				<li class="nav-item">
					<a class="nav-link" href="../../../../../../z80-kit/">Z80-KIT</a>
				</li>
				<li class="nav-item">
					<a class="nav-link" href="../../../../../../nascom/1/">Nascom 1</a>
				</li>
				<li class="nav-item">
					<a class="nav-link" href="../../../../../../nascom/">Nascom Journal</a>
				</li>
				<li class="nav-item">
					<a class="nav-link active" href="../../../../../../nascom/magazines/issues/">Nascom Magazines</a>
				</li>
				<li class="nav-item">
					<a class="nav-link" href="../../../../../../pico/">PICO</a>
				</li>
				<li class="nav-item">
					<a class="nav-link" href="../../../../../../cpm-plus/">CP/M</a>
				</li>
				<li class="nav-item">
					<a class="nav-link" href="../../../../../../">Tupel BBS</a>
				</li>
			</ul>
		</div>
	</div>
	</nav>

	<div class="container" style="max-width: 750px; color: #000; padding: 0 15px 0; background-color: #FFF">

<!--********************************************************************************-->

<!-- /navi-body.php / $Date: 2024-12-30 14:10:13 +0100 (Mo, 30. Dez 2024) $ -->
<table class="style-table-zeropadding" style="width: 100%">
<tr>
<td>
<h1 class="h1Navi">80-Bus News</h1>
</td>
<td>&nbsp;&nbsp;</td>
<td style="vertical-align:top">
<h2 class="h2Navi">Summer 1985 &middot; <span class="nowrap">Volume 4 &middot;</span> <span class="nowrap">Issue 2</span></h2>
</td>
</tr>
</table>
<!-- Navigation top -->
<table class="robots-nocontent style-table-zeropadding" style="width: 100%">
	<tr>
		<td class="navi-button">
			<a style="display: block" href="../../05/text/" title="Previous page"><span class="mirror-horizontal fas fa-play" aria-hidden=true></span></a>
		</td>
		<td class="navi-button">
			<a style="display: block" href="../../01/text/" title="First page"><span class="mirror-horizontal fas fa-fast-forward" aria-hidden=true></span></a>
		</td>
		<td class="navi-button">
			<a style="display: block" href="../../../41/01/text/" title="Previous issue"><span class="mirror-horizontal fas fa-forward" aria-hidden=true></span></a>
		</td>
		<th class="navi-button">
			<a style="display: block" href="../../text/" title="Table of Contents">Page 6 of 31</a>
		</th>
		<td class="navi-button">
			<a style="display: block" href="../../../../scorpio-news/11/01/text/" title="Next issue"><span class="fas fa-forward" aria-hidden=true></span></a>
		</td>
		<td class="navi-button">
			<a style="display: block" href="../../31/text/" title="Last page"><span class="fas fa-fast-forward" aria-hidden=true></span></a>
		</td>
		<td class="navi-button">
			<a style="display: block" href="../../07/text/" title="Next page"><span class="fas fa-play" aria-hidden=true></span></a>
		</td>
	</tr>
</table>
<!-- The page -->
<div class="row" lang="en">
<div class="col-sm-12 mag-80-bus-news issue-42 page-06" style="border: 1px solid #000; padding-top: 1em; padding-bottom: 1em;" lang="en" id="page">
<!-- 2(2) columns: start --><div><div class="style-multi-column-2 hyphenate 2">
<p>
L80 is much easier to use, which probably accounts
for its popularity, but does not give you the same
facilities as LINK. LINK, for example, will allow you
to generate overlay files (OVL), page relocatable
files (PRL), and will output a symbol table to disk
which could be useful. I only ever use LINK when
I need to generate any of these special filetypes for
the simple reason that the copy I have demands
that all the program modules are entered at the
start of the loading process and thus is not very
forgiving of the person that forgets to enter the odd
module name or two.
</p>
<p>
Back to overlays now, I recommend that you get
hold of the LINK program as it will make your life
a lot easier. A word of warning before we start. It
must be realized that whatever source language
has been used the first byte of the overlay file must
be an executable instruction and not a data area as
some compilers will create. All my &lsquo;C&rsquo; programs
compile down into MAC files and so I can alter the
data areas to suit before I create the overlays. Not
all of you will have this luxury so beware!
</p>
<p>
I will now explain the ins &amp; outs of overlaying using
the DR LINK linking loader. Let&rsquo;s assume that we
have created a program called ROOT and 3 overlay
modules called OV1, OV2 &amp; OV3, that will be used
by ROOT and are to be run in the same area of
memory. The source code has been compiled and
we have ROOT.REL, OV1.REL, OV2.REL and
OV3.REL on the disk ready to be turned into a COM
file with overlays. We now invoke LINK to do its
stuff by entering the following:
</p>
<pre>
    LINK ROOT (OV1} (OV2) (OV3) &lt;RET&gt;
</pre>
<p>
And off it goes. Easy isn&rsquo;t it? On completion you
will have created ROOT.COM and 3 overlays,
OV1.OVL and so on. LINK will have resolved any
global references between ROOT and the overlays
allowing an overlay to call routines or access
variables in the ROOT module. All the overlays will
have the same base address and that will be at the
start of the next 128 byte boundary above the top
of the root module.
</p>
<p>
It is possible to nest overlays using LINK so that
overlays themselves can call in and execute their
own overlays (Complex eh?). I will give you the
example in the book as I have not yet used this
facility and had better stick to safe ground. If you
take a look at the system memory map on the
overlay techniques diagram it may make the
following clearer. By way of an example let&rsquo;s say
we have a six overlay system; OV1 to 4 are to be
run in the main overlay area, while OV5 &amp; OV6 are
to be run in the secondary overlay area. 5 &amp; 6 are
to be called from OV2. If you enter the following:
</p>
<pre>
LINK ROOT (OV1) ((OV2) (OV5) (OV6)) (OV3) (OV4) 186
                 |- - - - - - - -|
                         |
                 5&amp;6 nested above 2
</pre>
<p>
all the overlays will be sorted out for you. Note the
parentheses are nested to indicate the relationship
between the overlay sections.
</p>
<p>
So you can see how easy it is once you have got to
this stage but we still have to understand some
more on the nitty gritty to enable us to program the
overlay loader that handles it all from the root
module.
</p>
<p>
When LINK creates a .OVL file it reads the REL file
and resolves the references as normal. It will
generate overlay code beginning from the start of
the next 128 byte boundary above the root end. The
output file (fname.OVL) is in effect a .COM file but
LINK will have added a 256 byte header to the
beginning of the OVL file. This header area is zero
filled except for four bytes. Bytes 1 and 2 (0 based)
will contain the length of the executable overlay
code, and bytes 7 and 8 will contain the base
address of the overlay code. What you as the writer
of the overlay loader have to do is extract this
information from the header and then read the
code into memory starting at the given base
address. Once the load is complete then you simply
transfer control to the base of the overlay code
using a CALL and away you go. As each OVL file
contains its own base address a single overlay
loading routine is all that is required to load any
OVL file.
</p>
<p>
The above process is a bit of a cheat as the
generation of overlay files by LINK was designed
specifically to interface with the DR PL-1 language,
which has an overlay manager in its library. We can
use it however if we take note of the little
idiosyncracies.
</p>
<p>
You will notice that the sample overlay loaders
(programs 2 &amp; 6) have the variables ?MEMRY and
?OVLA0 in them apparently doing nothing. These
are looked for by LINK and reported as undefined
if they do not exist as globals. The ?MEMRY word
is set to the overall top of program address by LINK
as it is creating the overlays. In other words it tells
you what the top address of the biggest overlay is
and may be used to determine free space or
whatever without jeopardizing any of the program
memory.
</p>
<p>
I have not got a clue what ?OVLA0 is meant to do,
if anyone knows, please let me in on the secret. I
have put it in the programs as a dummy global just
to get rid of those undefined global messages from
LINK.
</p>
<p>
Program 2 is an assembler source listing of a
working overlay loader, it can be used in conjunction
</p>
<!-- 2 columns: end --></div></div>

</div>
</div>
<!-- /The page -->
<!-- Navigation bottom -->
<table class="robots-nocontent style-table-zeropadding" style="width: 100%">
	<tr>
		<td class="navi-button">
			<a style="display: block" href="../../05/text/" title="Previous page"><span class="mirror-horizontal fas fa-play" aria-hidden=true></span></a>
		</td>
		<td class="navi-button">
			<a style="display: block" href="../../01/text/" title="First page"><span class="mirror-horizontal fas fa-fast-forward" aria-hidden=true></span></a>
		</td>
		<td class="navi-button">
			<a style="display: block" href="../../../41/01/text/" title="Previous issue"><span class="mirror-horizontal fas fa-forward" aria-hidden=true></span></a>
		</td>
		<th class="navi-button">
			<a style="display: block" href="../../text/" title="Table of Contents">Page 6 of 31</a>
		</th>
		<td class="navi-button">
			<a style="display: block" href="../../../../scorpio-news/11/01/text/" title="Next issue"><span class="fas fa-forward" aria-hidden=true></span></a>
		</td>
		<td class="navi-button">
			<a style="display: block" href="../../31/text/" title="Last page"><span class="fas fa-fast-forward" aria-hidden=true></span></a>
		</td>
		<td class="navi-button">
			<a style="display: block" href="../../07/text/" title="Next page"><span class="fas fa-play" aria-hidden=true></span></a>
		</td>
	</tr>
</table>

<!-- navi-footer.php / $Date: 2023-03-11 15:22:20 +0100 (Sa, 11. Mrz 2023) $ -->

<!--********************************************************************************-->

	</div>

	<nav class="nav flex-column flex-md-row style-navbar-bottom robots-nocontent"> <!--nav-pills-->
		<a class="sm-fill nav-link" href="#top"><span title="Nach oben" class="fa fa-chevron-up" aria-hidden=true></span></a>
		<a class="sm-fill nav-link" href="../">Graphic</a>
		<a class="sm-fill nav-link" href="https://80bus.co.uk.mirror.jloh.de/publications/magazines/80bus_news_42.pdf#page=6" target="_blank">PDF</a>
		<a class="sm-fill nav-link" href="../../../../../../datenschutzerklaerung/">Privacy Statement</a>
		<a class="sm-fill nav-link" href="../../../../../../impressum/">Imprint</a>
	</nav>

	<!--bootstrap-->
	<script src="../../../../../../cdn/bootstrap/js/bootstrap.bundle.min.js"></script>
</body>

<!-- /navi-footer.php -->
</html>

<!-- /page.php -->