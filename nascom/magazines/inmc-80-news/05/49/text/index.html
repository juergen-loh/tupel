<!doctype html>
<html lang="de">

<!-- navi-head.php / $Date: 2025-01-05 17:13:18 +0100 (So, 05. Jan 2025) $ -->
<head>
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<meta charset="utf-8">

	<link rel="shortcut icon" type="image/x-icon" href="../../../../../../nascom/nascom.ico">
	<link rel="icon" type="image/png" href="../../../../../../nascom/apple-touch-icon.png" sizes="32x32">
	<link rel="icon" type="image/png" href="../../../../../../nascom/apple-touch-icon.png" sizes="96x96">
	<link rel="apple-touch-icon" sizes="180x180" href="../../../../../../nascom/apple-touch-icon.png">

	<!--bootstrap-->
	<link rel="stylesheet" href="../../../../../../cdn/bootstrap/css/bootstrap.min.css">

	<!--font awesome-->
	<link rel="stylesheet" href="../../../../../../cdn/fontawesome/css/fontawesome.min.css">
	<link rel="stylesheet" href="../../../../../../cdn/fontawesome/css/solid.min.css">

	<link rel="stylesheet" type="text/css" href="../../../../../../style.css">
	<link rel="canonical" href="https://tupel.jloh.de/nascom/magazines/inmc-80-news/05/49/text/">
<!-- /navi-head.php -->

	<!-- page.php / $Date: 2024-07-13 18:55:41 +0200 (Sa, 13. Jul 2024) $ -->

	<title>INMC 80 News - October&ndash;December 1981 - Issue 5</title>
	<!-- Sun, 05 Jan 2025 16:13:18 GMT -->
	<meta name="keywords" content="INMC 80 News, Nascom Computer, Nascom 1, Nascom 2">
	<link rel="stylesheet" type="text/css" href="../../../style.css">
<!-- navi-body.php -->
</head>

<body>
	<nav class="navbar navbar-expand-md navbar-light bg-light style-navbar-top" id="top">
	<div class="container-fluid">
		<a class="navbar-brand" href="https://jloh.de/">
			<img src="../../../../../../favicon.ico" width="32" height="32" alt="JL" title="Homepage von JÃ¼rgen Loh">
		</a>
		<button
			class="navbar-toggler"
			type="button"
			data-bs-toggle="collapse"
			data-bs-target="#navbarSupportedContent"
			aria-controls="navbarSupportedContent"
			aria-expanded="false"
			aria-label="Toggle navigation"
		>
			<span class="navbar-toggler-icon"></span>
		</button>
		<div class="collapse navbar-collapse robots-nocontent" id="navbarSupportedContent">
			<ul class="navbar-nav md-auto">
				<li class="nav-item">
					<a class="nav-link" href="../../../../../../z80-kit/">Z80-KIT</a>
				</li>
				<li class="nav-item">
					<a class="nav-link" href="../../../../../../nascom/1/">Nascom 1</a>
				</li>
				<li class="nav-item">
					<a class="nav-link" href="../../../../../../nascom/">Nascom Journal</a>
				</li>
				<li class="nav-item">
					<a class="nav-link active" href="../../../../../../nascom/magazines/issues/">Nascom Magazines</a>
				</li>
				<li class="nav-item">
					<a class="nav-link" href="../../../../../../pico/">PICO</a>
				</li>
				<li class="nav-item">
					<a class="nav-link" href="../../../../../../cpm-plus/">CP/M</a>
				</li>
				<li class="nav-item">
					<a class="nav-link" href="../../../../../../">Tupel BBS</a>
				</li>
			</ul>
		</div>
	</div>
	</nav>

	<div class="container" style="max-width: 750px; color: #000; padding: 0 15px 0; background-color: #FFF">

<!--********************************************************************************-->

<!-- /navi-body.php / $Date: 2024-12-30 14:10:13 +0100 (Mo, 30. Dez 2024) $ -->
<table class="style-table-zeropadding" style="width: 100%">
<tr>
<td>
<h1 class="h1Navi">INMC 80 News</h1>
</td>
<td>&nbsp;&nbsp;</td>
<td style="vertical-align:top">
<h2 class="h2Navi">October&ndash;December 1981 &middot; <span class="nowrap">Issue 5</span></h2>
</td>
</tr>
</table>
<!-- Navigation top -->
<table class="robots-nocontent style-table-zeropadding" style="width: 100%">
	<tr>
		<td class="navi-button">
			<a style="display: block" href="../../48/text/" title="Previous page"><span class="mirror-horizontal fas fa-play" aria-hidden=true></span></a>
		</td>
		<td class="navi-button">
			<a style="display: block" href="../../01/text/" title="First page"><span class="mirror-horizontal fas fa-fast-forward" aria-hidden=true></span></a>
		</td>
		<td class="navi-button">
			<a style="display: block" href="../../../04/01/text/" title="Previous issue"><span class="mirror-horizontal fas fa-forward" aria-hidden=true></span></a>
		</td>
		<th class="navi-button">
			<a style="display: block" href="../../text/" title="Table of Contents">Page 49 of 71</a>
		</th>
		<td class="navi-button">
			<a style="display: block" href="../../../../80-bus-news/11/01/text/" title="Next issue"><span class="fas fa-forward" aria-hidden=true></span></a>
		</td>
		<td class="navi-button">
			<a style="display: block" href="../../71/text/" title="Last page"><span class="fas fa-fast-forward" aria-hidden=true></span></a>
		</td>
		<td class="navi-button">
			<a style="display: block" href="../../50/text/" title="Next page"><span class="fas fa-play" aria-hidden=true></span></a>
		</td>
	</tr>
</table>
<!-- The page -->
<div class="row" lang="en">
<div class="col-sm-12 mag-inmc-80-news issue-05 page-49" style="border: 1px solid #000; padding-top: 1em; padding-bottom: 1em;" lang="en" id="page">
<!-- 1 column: start --><div>
<p class="continued">
which is, of course the ASCII code for 5. Now it wasn&rsquo;t really magic, it was
knowing the effects of the DAA instruction which is the heart of this whole
routine. I confess, that given the original specification, my approach would
have been a lot more long winded, and I don&rsquo;t suppose for one minute that I
would have thought of using the DAA instruction in this way. The ADC A,40H can
be thought of as a &lsquo;fiddle factor&rsquo;, but the result is what was required. The
whole piece of code from line 4525 to 4540 must be though of as a single piece
of bit manipulation, and can only be arrived be very careful though and
thorough knowledge of the effects of the instructions.
</p>
<p>
Line 4550. Go and print the character on the screen.
</p>
<p>
Line 4555. Get the return address off the STACK and go back to where
eve you came from.
</p>
<p>
And here endeth the lesson. What&rsquo;s been learned? Well, firstly and
most important, the fact that instructions may be intended for one purpose, but
that does not impose a constraint on their imaginative use for other purposes.
The two crucial instructions are the DAA and the ADC A,40H. Knowing exactly the
effect of the DAA allows the programmer to deduce the required &lsquo;fiddle factor&rsquo;
to make the routine work correctly. Another thing has been the correct and
orderly use of the STACK. See how neatly the whole thing comes together. The SP
is always in the right place when data is wanted, and simple PUSH, POP, (not so
simple) CALL and RET instructions always retrieved the correct data at the
right time. The way the routine CALLed the second half the first time round,
but simply dropped through the second time, thus saving one CALL instruction,
and one additional RET instruction, so saving four bytes. (Not that space is
usually at a premium, but there is an awful lot crammed into the 2K of
NAS-SYS). I hope you all understand how the B2HEX routine works now, and
hopefully, my commenting of the routine made for easier understanding.
</p>
<p>
Try commenting some of the other routines in the monitor. If you can&rsquo;t
see how they work from the listing, there&rsquo;s nothing to stop you writing a
simple piece of code which will pre-fill the registers with the right data and
then CALLing the routine in question via a single step command. It&rsquo;s quite
revealing when you do it that way, you see all the registers change as the
routine steps though, and you can see the sometimes hidden effects of the flags
as it goes along. If you have NAS-DIS and D-BUG, so much the better, the
display is so much clearer. Personally I find the register display of NAS-SYS&nbsp;3
a retrograde step, as, although it gives much more information, it&rsquo;s confusing
to read.
</p>
<p>
Now for the ultimate confession. When I started to write this piece, I
didn&rsquo;t know how B2HEX worked either. Of course I&rsquo;d looked at, but the
significance of the DAA instructions hadn&rsquo;t caught my eye. I had just taken it
as a &lsquo;black box&rsquo; module and not given it any attention. Imagine my surprise
when I actually sat down and single stepped through it (I&rsquo;ve got to do that,
&rsquo;cos if I get it wrong, think of the delight you&rsquo;d get writing me rude letters)
and then tried to figure out exactly how it performed the magic conversion. I
phoned Richard to confirm I&rsquo;d got it right, and to ask how he&rsquo;d invented that
particular way of, doing it. It was then I discovered that Richard wasn&rsquo;t the
perpetrator of the particular piece of code. In writing NAS-SYS&nbsp;1, Richard had
run out of space by about 20 &ndash; 30 bytes, so he spoke to David Parkinson (of
REVAS, NAS-DIS and <span class="uppercase">Gemini</span> disk system fame) and asked if he could think of any
ways of losing a few bytes. Dave came up with this one, and a couple in the KBD
routine which saved the day. Incedently, I now know why I&rsquo;ve never been able to
fully understand how the keyboard routine works. David Parkinson has been at
it!!!
</p>
<p>
Still, give David his due, he&rsquo;s far cleverer at this programming lark
than I will ever be. My excuse? I gave that in episode one, when I said that I
started off knowing nothing, and I don&rsquo;t suppose I learned much since. I&rsquo;ll
remember B2HEX though!!
</p>
<!-- 1 column: end --></div>

</div>
</div>
<!-- /The page -->
<!-- Navigation bottom -->
<table class="robots-nocontent style-table-zeropadding" style="width: 100%">
	<tr>
		<td class="navi-button">
			<a style="display: block" href="../../48/text/" title="Previous page"><span class="mirror-horizontal fas fa-play" aria-hidden=true></span></a>
		</td>
		<td class="navi-button">
			<a style="display: block" href="../../01/text/" title="First page"><span class="mirror-horizontal fas fa-fast-forward" aria-hidden=true></span></a>
		</td>
		<td class="navi-button">
			<a style="display: block" href="../../../04/01/text/" title="Previous issue"><span class="mirror-horizontal fas fa-forward" aria-hidden=true></span></a>
		</td>
		<th class="navi-button">
			<a style="display: block" href="../../text/" title="Table of Contents">Page 49 of 71</a>
		</th>
		<td class="navi-button">
			<a style="display: block" href="../../../../80-bus-news/11/01/text/" title="Next issue"><span class="fas fa-forward" aria-hidden=true></span></a>
		</td>
		<td class="navi-button">
			<a style="display: block" href="../../71/text/" title="Last page"><span class="fas fa-fast-forward" aria-hidden=true></span></a>
		</td>
		<td class="navi-button">
			<a style="display: block" href="../../50/text/" title="Next page"><span class="fas fa-play" aria-hidden=true></span></a>
		</td>
	</tr>
</table>

<!-- navi-footer.php / $Date: 2023-03-11 15:22:20 +0100 (Sa, 11. Mrz 2023) $ -->

<!--********************************************************************************-->

	</div>

	<nav class="nav flex-column flex-md-row style-navbar-bottom robots-nocontent"> <!--nav-pills-->
		<a class="sm-fill nav-link" href="#top"><span title="Nach oben" class="fa fa-chevron-up" aria-hidden=true></span></a>
		<a class="sm-fill nav-link" href="../">Graphic</a>
		<a class="sm-fill nav-link" href="https://80bus.co.uk.mirror.jloh.de/publications/magazines/INMC_80_News_5.pdf#page=49" target="_blank">PDF</a>
		<a class="sm-fill nav-link" href="../../../../../../datenschutzerklaerung/">Privacy Statement</a>
		<a class="sm-fill nav-link" href="../../../../../../impressum/">Imprint</a>
	</nav>

	<!--bootstrap-->
	<script src="../../../../../../cdn/bootstrap/js/bootstrap.bundle.min.js"></script>
</body>

<!-- /navi-footer.php -->
</html>

<!-- /page.php -->