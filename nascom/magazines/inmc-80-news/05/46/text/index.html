<!doctype html>
<html lang="de">

<!-- navi-head.php / $Date: 2025-01-05 17:13:18 +0100 (So, 05. Jan 2025) $ -->
<head>
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<meta charset="utf-8">

	<link rel="shortcut icon" type="image/x-icon" href="../../../../../../nascom/nascom.ico">
	<link rel="icon" type="image/png" href="../../../../../../nascom/apple-touch-icon.png" sizes="32x32">
	<link rel="icon" type="image/png" href="../../../../../../nascom/apple-touch-icon.png" sizes="96x96">
	<link rel="apple-touch-icon" sizes="180x180" href="../../../../../../nascom/apple-touch-icon.png">

	<!--bootstrap-->
	<link rel="stylesheet" href="../../../../../../cdn/bootstrap/css/bootstrap.min.css">

	<!--font awesome-->
	<link rel="stylesheet" href="../../../../../../cdn/fontawesome/css/fontawesome.min.css">
	<link rel="stylesheet" href="../../../../../../cdn/fontawesome/css/solid.min.css">

	<link rel="stylesheet" type="text/css" href="../../../../../../style.css">
	<link rel="canonical" href="https://tupel.jloh.de/nascom/magazines/inmc-80-news/05/46/text/">
<!-- /navi-head.php -->

	<!-- page.php / $Date: 2024-07-13 18:55:41 +0200 (Sa, 13. Jul 2024) $ -->

	<title>INMC 80 News - October&ndash;December 1981 - Issue 5</title>
	<!-- Sun, 05 Jan 2025 16:13:18 GMT -->
	<meta name="keywords" content="INMC 80 News, Nascom Computer, Nascom 1, Nascom 2">
	<link rel="stylesheet" type="text/css" href="../../../style.css">
<!-- navi-body.php -->
</head>

<body>
	<nav class="navbar navbar-expand-md navbar-light bg-light style-navbar-top" id="top">
	<div class="container-fluid">
		<a class="navbar-brand" href="https://jloh.de/">
			<img src="../../../../../../favicon.ico" width="32" height="32" alt="JL" title="Homepage von JÃ¼rgen Loh">
		</a>
		<button
			class="navbar-toggler"
			type="button"
			data-bs-toggle="collapse"
			data-bs-target="#navbarSupportedContent"
			aria-controls="navbarSupportedContent"
			aria-expanded="false"
			aria-label="Toggle navigation"
		>
			<span class="navbar-toggler-icon"></span>
		</button>
		<div class="collapse navbar-collapse robots-nocontent" id="navbarSupportedContent">
			<ul class="navbar-nav md-auto">
				<li class="nav-item">
					<a class="nav-link" href="../../../../../../z80-kit/">Z80-KIT</a>
				</li>
				<li class="nav-item">
					<a class="nav-link" href="../../../../../../nascom/1/">Nascom 1</a>
				</li>
				<li class="nav-item">
					<a class="nav-link" href="../../../../../../nascom/">Nascom Journal</a>
				</li>
				<li class="nav-item">
					<a class="nav-link active" href="../../../../../../nascom/magazines/issues/">Nascom Magazines</a>
				</li>
				<li class="nav-item">
					<a class="nav-link" href="../../../../../../pico/">PICO</a>
				</li>
				<li class="nav-item">
					<a class="nav-link" href="../../../../../../cpm-plus/">CP/M</a>
				</li>
				<li class="nav-item">
					<a class="nav-link" href="../../../../../../">Tupel BBS</a>
				</li>
			</ul>
		</div>
	</div>
	</nav>

	<div class="container" style="max-width: 750px; color: #000; padding: 0 15px 0; background-color: #FFF">

<!--********************************************************************************-->

<!-- /navi-body.php / $Date: 2024-12-30 14:10:13 +0100 (Mo, 30. Dez 2024) $ -->
<table class="style-table-zeropadding" style="width: 100%">
<tr>
<td>
<h1 class="h1Navi">INMC 80 News</h1>
</td>
<td>&nbsp;&nbsp;</td>
<td style="vertical-align:top">
<h2 class="h2Navi">October&ndash;December 1981 &middot; <span class="nowrap">Issue 5</span></h2>
</td>
</tr>
</table>
<!-- Navigation top -->
<table class="robots-nocontent style-table-zeropadding" style="width: 100%">
	<tr>
		<td class="navi-button">
			<a style="display: block" href="../../45/text/" title="Previous page"><span class="mirror-horizontal fas fa-play" aria-hidden=true></span></a>
		</td>
		<td class="navi-button">
			<a style="display: block" href="../../01/text/" title="First page"><span class="mirror-horizontal fas fa-fast-forward" aria-hidden=true></span></a>
		</td>
		<td class="navi-button">
			<a style="display: block" href="../../../04/01/text/" title="Previous issue"><span class="mirror-horizontal fas fa-forward" aria-hidden=true></span></a>
		</td>
		<th class="navi-button">
			<a style="display: block" href="../../text/" title="Table of Contents">Page 46 of 71</a>
		</th>
		<td class="navi-button">
			<a style="display: block" href="../../../../80-bus-news/11/01/text/" title="Next issue"><span class="fas fa-forward" aria-hidden=true></span></a>
		</td>
		<td class="navi-button">
			<a style="display: block" href="../../71/text/" title="Last page"><span class="fas fa-fast-forward" aria-hidden=true></span></a>
		</td>
		<td class="navi-button">
			<a style="display: block" href="../../47/text/" title="Next page"><span class="fas fa-play" aria-hidden=true></span></a>
		</td>
	</tr>
</table>
<!-- The page -->
<div class="row" lang="en">
<div class="col-sm-12 mag-inmc-80-news issue-05 page-46" style="border: 1px solid #000; padding-top: 1em; padding-bottom: 1em;" lang="en" id="page">
<!-- 1 column: start --><div>
<p>
When dealing with a subroutine in isolation, we have to make some
assumptions, firstly that the data to be printed has already been put in the A
register, and for the purposes of demonstration, this is going to be B5H. Next
we assume the routine has been CALLed in an orderly fashion, implying that the
STACK is already correctly set, and left pointing at the last byte saved (in
this instance, because the routine was CALLed, pointing at the low byte of the
return address (as the PC will have already been advanced to the correct return
address by the CALL instruction before the return data was placed on the STACK,
see episodes 3 and 4).
</p>
<p>
Ok. Oft we jolly well go!!
</p>
<p>
Line 4470. This is a brief comment as to what we propose to do, viz:
OUTPUT A.
</p>
<p>
Line 4475. This is the start of the routine, and is labelled B2HEX
accordingly. The instruction is PUSH AF, which will put the current contents of
registers A and F onto the STACK. The STACK will contain B5H as it&rsquo;s higher
byte (because I&rsquo;ve already said that A contains B5H), and XX as it&rsquo;s lower byte
(because that state of the F register was indeterminate when we PUSHed the AF
register, and we don&rsquo;t care a damn what it contains). The SP has been
decremented by two. We PUSHed AF because the calculation process will destroy
the current contents of the A register, and we need it back to work out the
second half. As a matter of interest, we could have equally well saved the
contents of A in some other register, which would have been slightly quicker in
terms of execution time, but as the specification implies that all other
registers except A remain unchanged, we would have had to save the contents of
the other register anyway, so what odds!!
</p>
<p>
Lines 4480 to 4495. This is a fun one! If you think about it, an 8 bit
byte expressed in HEX contains two alpha numeric characters, and each character
can be said to represent a nibble of the 8 bit byte. Now the order they appear
on the screen says that the highest nibble will be printed first. So because of
the way the routine works (wait for it), we&rsquo;ve got to move the high nibble into
the place currently occupied by the low nibble. This is done by moving
everything four places to the right (no political cracks please). More
precisely, four &lsquo;Rotate Right Arithmetic&rsquo; (RRA) instructions are used (shift
instructions would have worked just as well, but someone in pre-history
dictated that rotate instructions would be used). The rotate right moves the
contents of the C flag into the highest bit, everything else right one place,
and the bit that drops off the end into the C flag. Lets follow that
diagramatically:
</p>
<table class="rottab">
<tr><td>B5H equals</td><td>10110101</td><td>X</td><td>in binary bits, the X is the C flag.</td></tr>
<tr><td></td><td></td><td></td><td>Now rotate it one</td></tr>
<tr><td></td><td>X1011010</td><td>1</td><td>the C flag, X has been moved into the highest bit
											everything else has moved right one place, and
											the lowest bit has moved into the C flag.</td></tr>
<tr><td></td><td></td><td></td><td>Rotate again</td></tr>
<tr><td></td><td>1X101101</td><td>0</td><td>Rotate again</td></tr>
<tr><td></td><td>01X10110</td><td>1</td><td>and for the last time</td></tr>
<tr><td></td><td>101X1011</td><td>0</td><td></td></tr>
</table>
<p class="noindent">
Simple really, and the end result is that the &lsquo;B&rsquo; of B5H has been moved into
the low nibble.
</p>
<p>
Line 4500. Now to call the calculation routine using the NAS-SYS RCAL
routine. Don&rsquo;t worry how that works, just pretend it&rsquo;s a CALL as per the Z80
manual. The CALL instruction PUSHes the return address (037C) onto the STACK,
and loads the PC with the address CALLed, 037D, so we skip along to line 4515.
</p>
<!-- 1 column: end --></div>

</div>
</div>
<!-- /The page -->
<!-- Navigation bottom -->
<table class="robots-nocontent style-table-zeropadding" style="width: 100%">
	<tr>
		<td class="navi-button">
			<a style="display: block" href="../../45/text/" title="Previous page"><span class="mirror-horizontal fas fa-play" aria-hidden=true></span></a>
		</td>
		<td class="navi-button">
			<a style="display: block" href="../../01/text/" title="First page"><span class="mirror-horizontal fas fa-fast-forward" aria-hidden=true></span></a>
		</td>
		<td class="navi-button">
			<a style="display: block" href="../../../04/01/text/" title="Previous issue"><span class="mirror-horizontal fas fa-forward" aria-hidden=true></span></a>
		</td>
		<th class="navi-button">
			<a style="display: block" href="../../text/" title="Table of Contents">Page 46 of 71</a>
		</th>
		<td class="navi-button">
			<a style="display: block" href="../../../../80-bus-news/11/01/text/" title="Next issue"><span class="fas fa-forward" aria-hidden=true></span></a>
		</td>
		<td class="navi-button">
			<a style="display: block" href="../../71/text/" title="Last page"><span class="fas fa-fast-forward" aria-hidden=true></span></a>
		</td>
		<td class="navi-button">
			<a style="display: block" href="../../47/text/" title="Next page"><span class="fas fa-play" aria-hidden=true></span></a>
		</td>
	</tr>
</table>

<!-- navi-footer.php / $Date: 2023-03-11 15:22:20 +0100 (Sa, 11. Mrz 2023) $ -->

<!--********************************************************************************-->

	</div>

	<nav class="nav flex-column flex-md-row style-navbar-bottom robots-nocontent"> <!--nav-pills-->
		<a class="sm-fill nav-link" href="#top"><span title="Nach oben" class="fa fa-chevron-up" aria-hidden=true></span></a>
		<a class="sm-fill nav-link" href="../">Graphic</a>
		<a class="sm-fill nav-link" href="https://80bus.co.uk.mirror.jloh.de/publications/magazines/INMC_80_News_5.pdf#page=46" target="_blank">PDF</a>
		<a class="sm-fill nav-link" href="../../../../../../datenschutzerklaerung/">Privacy Statement</a>
		<a class="sm-fill nav-link" href="../../../../../../impressum/">Imprint</a>
	</nav>

	<!--bootstrap-->
	<script src="../../../../../../cdn/bootstrap/js/bootstrap.bundle.min.js"></script>
</body>

<!-- /navi-footer.php -->
</html>

<!-- /page.php -->